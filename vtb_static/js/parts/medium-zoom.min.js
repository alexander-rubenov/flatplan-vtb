"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):window.mediumZoom=t()}(0,function(){var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t=function(e){return"IMG"===e.tagName},o=function(e){return e&&1===e.nodeType},n=function(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()},i=function(e){try{return Array.isArray(e)?e.filter(t):function(e){return NodeList.prototype.isPrototypeOf(e)}(e)?[].slice.call(e).filter(t):o(e)?[e].filter(t):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(t):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},r=function(t,o){var n=e({bubbles:!1,cancelable:!1,detail:void 0},o);if("function"==typeof window.CustomEvent)return new CustomEvent(t,n);var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i};return function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}"),function t(d){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=window.Promise||function(e){function t(){}e(t,t)},c=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var n=t.reduce(function(e,t){return[].concat(e,i(t))},[]);return n.filter(function(e){return-1===f.indexOf(e)}).forEach(function(e){f.push(e),e.classList.add("medium-zoom-image")}),p.forEach(function(e){var t=e.type,o=e.listener,i=e.options;n.forEach(function(e){e.addEventListener(t,o,i)})}),b},l=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,i=function(){var t={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},i=void 0,r=void 0;if(h.container)if(h.container instanceof Object)i=(t=e({},t,h.container)).width-t.left-t.right-2*h.margin,r=t.height-t.top-t.bottom-2*h.margin;else{var d=(o(h.container)?h.container:document.querySelector(h.container)).getBoundingClientRect(),m=d.width,a=d.height,c=d.left,l=d.top;t=e({},t,{width:m,height:a,left:c,top:l})}i=i||t.width-2*h.margin,r=r||t.height-2*h.margin;var u=z.zoomedHd||z.original,s=n(u)?i:u.naturalWidth||i,f=n(u)?r:u.naturalHeight||r,p=u.getBoundingClientRect(),g=p.top,v=p.left,y=p.width,b=p.height,E=Math.min(s,i)/y,w=Math.min(f,r)/b,L=Math.min(E,w),H="scale("+L+") translate3d("+((i-y)/2-v+h.margin+t.left)/L+"px, "+((r-b)/2-g+h.margin+t.top)/L+"px, 0)";z.zoomed.style.transform=H,z.zoomedHd&&(z.zoomedHd.style.transform=H)};return new a(function(e){if(t&&-1===f.indexOf(t))e(b);else if(z.zoomed)e(b);else{if(t)z.original=t;else{if(!(f.length>0))return void e(b);var n=f;z.original=n[0]}if(z.original.dispatchEvent(r("medium-zoom:open",{detail:{zoom:b}})),v=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,g=!0,z.zoomed=function(e){var t=e.getBoundingClientRect(),o=t.top,n=t.left,i=t.width,r=t.height,d=e.cloneNode(),m=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,a=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return d.removeAttribute("id"),d.style.position="absolute",d.style.top=o+m+"px",d.style.left=n+a+"px",d.style.width=i+"px",d.style.height=r+"px",d.style.transform="",d}(z.original),document.body.appendChild(y),h.template){var d=o(h.template)?h.template:document.querySelector(h.template);z.template=document.createElement("div"),z.template.appendChild(d.content.cloneNode(!0)),document.body.appendChild(z.template)}if(document.body.appendChild(z.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),z.original.classList.add("medium-zoom-image--hidden"),z.zoomed.classList.add("medium-zoom-image--opened"),z.zoomed.addEventListener("click",u),z.zoomed.addEventListener("transitionend",function t(){g=!1,z.zoomed.removeEventListener("transitionend",t),z.original.dispatchEvent(r("medium-zoom:opened",{detail:{zoom:b}})),e(b)}),z.original.getAttribute("data-zoom-src")){z.zoomedHd=z.zoomed.cloneNode(),z.zoomedHd.removeAttribute("srcset"),z.zoomedHd.removeAttribute("sizes"),z.zoomedHd.src=z.zoomed.getAttribute("data-zoom-src"),z.zoomedHd.onerror=function(){clearInterval(m),console.warn("Unable to reach the zoom image target "+z.zoomedHd.src),z.zoomedHd=null,i()};var m=setInterval(function(){z.zoomedHd.complete&&(clearInterval(m),z.zoomedHd.classList.add("medium-zoom-image--opened"),z.zoomedHd.addEventListener("click",u),document.body.appendChild(z.zoomedHd),i())},10)}else if(z.original.hasAttribute("srcset")){z.zoomedHd=z.zoomed.cloneNode(),z.zoomedHd.removeAttribute("sizes");var a=z.zoomedHd.addEventListener("load",function(){z.zoomedHd.removeEventListener("load",a),z.zoomedHd.classList.add("medium-zoom-image--opened"),z.zoomedHd.addEventListener("click",u),document.body.appendChild(z.zoomedHd),i()})}else i()}})},u=function(){return new a(function(e){!g&&z.original?(g=!0,document.body.classList.remove("medium-zoom--opened"),z.zoomed.style.transform="",z.zoomedHd&&(z.zoomedHd.style.transform=""),z.template&&(z.template.style.transition="opacity 150ms",z.template.style.opacity=0),z.original.dispatchEvent(r("medium-zoom:close",{detail:{zoom:b}})),z.zoomed.addEventListener("transitionend",function t(){z.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(z.zoomed),z.zoomedHd&&document.body.removeChild(z.zoomedHd),document.body.removeChild(y),z.zoomed.classList.remove("medium-zoom-image--opened"),z.template&&document.body.removeChild(z.template),g=!1,z.zoomed.removeEventListener("transitionend",t),z.original.dispatchEvent(r("medium-zoom:closed",{detail:{zoom:b}})),z.original=null,z.zoomed=null,z.zoomedHd=null,z.template=null,e(b)})):e(b)})},s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target;return z.original?u():l({target:e})},f=[],p=[],g=!1,v=0,h=m,z={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(d)?h=d:(d||"string"==typeof d)&&c(d);var y=function(e){var t=document.createElement("div");return t.classList.add("medium-zoom-overlay"),t.style.background=e,t}((h=e({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},h)).background);document.addEventListener("click",function(e){var t=e.target;t!==y?-1!==f.indexOf(t)&&s({target:t}):u()}),document.addEventListener("keyup",function(e){27===(e.keyCode||e.which)&&u()}),document.addEventListener("scroll",function(){if(!g&&z.original){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(v-e)>h.scrollOffset&&setTimeout(u,150)}}),window.addEventListener("resize",u);var b={open:l,close:u,toggle:s,update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t;if(t.background&&(y.style.background=t.background),t.container&&t.container instanceof Object&&(n.container=e({},h.container,t.container)),t.template){var i=o(t.template)?t.template:document.querySelector(t.template);n.template=i}return h=e({},h,n),f.forEach(function(e){e.dispatchEvent(r("medium-zoom:update",{detail:{zoom:b}}))}),b},clone:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(e({},h,o))},attach:c,detach:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];z.zoomed&&u();var n=t.length>0?t.reduce(function(e,t){return[].concat(e,i(t))},[]):f;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(r("medium-zoom:detach",{detail:{zoom:b}}))}),f=f.filter(function(e){return-1===n.indexOf(e)}),b},on:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(n){n.addEventListener("medium-zoom:"+e,t,o)}),p.push({type:"medium-zoom:"+e,listener:t,options:o}),b},off:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(n){n.removeEventListener("medium-zoom:"+e,t,o)}),p=p.filter(function(o){return!(o.type==="medium-zoom:"+e&&o.listener.toString()===t.toString())}),b},getOptions:function(){return h},getImages:function(){return f},getZoomedImage:function(){return z.original}};return b}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcnRzL21lZGl1bS16b29tLmpzIl0sIm5hbWVzIjpbImdsb2JhbCIsImZhY3RvcnkiLCJleHBvcnRzIiwiX3R5cGVvZiIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsIm1lZGl1bVpvb20iLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJub2RlIiwidGFnTmFtZSIsImlzTm9kZSIsInNlbGVjdG9yIiwibm9kZVR5cGUiLCJpc1N2ZyIsImltYWdlIiwiY3VycmVudFNyYyIsInNyYyIsInN1YnN0ciIsInRvTG93ZXJDYXNlIiwiZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yIiwiaXNQcm90b3R5cGVPZiIsIkFycmF5IiwiaXNBcnJheSIsIk5vZGVMaXN0IiwiaXNOb2RlTGlzdCIsInNsaWNlIiwiZmlsdGVyIiwiaXNTdXBwb3J0ZWQiLCJkb2N1bWVudCIsIlR5cGVFcnJvciIsIm92ZXJsYXkiLCJ0eXBlIiwicGFyYW1zIiwiZXZlbnRQYXJhbXMiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImNsb25lVGFyZ2V0IiwiX3RlbXBsYXRlJGdldEJvdW5kaW5nIiwibGVmdCIsImhlaWdodCIsImN1c3RvbUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiem9vbSIsInJlZiIsImluc2VydEF0IiwiYWN0aXZlIiwidGVtcGxhdGUiLCJoZWFkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJyZXNvbHZlIiwiY3JlYXRlRWxlbWVudCIsInN0eWxlIiwiaXNBbmltYXRpbmciLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJmaXJzdENoaWxkIiwiYXBwZW5kQ2hpbGQiLCJjc3NUZXh0IiwidHJhbnNpdGlvbiIsImNyZWF0ZVRleHROb2RlIiwiY3NzIiwicGFnZVhPZmZzZXQiLCJjbG9uZSIsInJlbW92ZUF0dHJpYnV0ZSIsInVuZGVmaW5lZCIsInBvc2l0aW9uIiwiUHJvbWlzZSIsImZuIiwidG9wIiwiTWF0aCIsInNjcm9sbFRvcCIsInNldFRpbWVvdXQiLCJzZWxlY3RvcnMiLCJfbGVuIiwiX2tleSIsIm5ld0ltYWdlcyIsInJlZHVjZSIsImltYWdlc0FjY3VtdWxhdG9yIiwiY3VycmVudFNlbGVjdG9yIiwiX2hhbmRsZUtleVVwIiwiY29uY2F0IiwiZXZlbnQiLCJjbG9zZSIsIm5ld0ltYWdlIiwiaW1hZ2VzIiwiaW5kZXhPZiIsImZvckVhY2giLCJwdXNoIiwidXBkYXRlIiwiZXZlbnRMaXN0ZW5lcnMiLCJvcHRpb25zIiwiX3JlZiIsImxpc3RlbmVyIiwiYmFja2dyb3VuZCIsIm9wZW4iLCJfYW5pbWF0ZSIsImRldGFjaCIsImNvbnRhaW5lciIsIndpZHRoIiwiX2xlbjIiLCJfa2V5MiIsImNsaWVudEhlaWdodCIsInpvb21lZCIsInZpZXdwb3J0V2lkdGgiLCJpbWFnZXNUb0RldGFjaCIsInpvb21PcHRpb25zIiwicmlnaHQiLCJtYXJnaW4iLCJkaXNwYXRjaEV2ZW50IiwiY3JlYXRlQ3VzdG9tRXZlbnQiLCJib3R0b20iLCJfem9vbUNvbnRhaW5lciRnZXRCb3UiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJfd2lkdGgiLCJfaGVpZ2h0IiwiX2xlZnQiLCJfdG9wIiwib3JpZ2luYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiem9vbVRhcmdldCIsIm5hdHVyYWxXaWR0aCIsIm5hdHVyYWxIZWlnaHQiLCJ2aWV3cG9ydEhlaWdodCIsIl96b29tVGFyZ2V0JGdldEJvdW5kaSIsInNjYWxlWCIsIm1pbiIsInRyYW5zZm9ybSIsInNjYWxlIiwiem9vbWVkSGQiLCJldmVudExpc3RlbmVyIiwiX2ltYWdlcyIsInpvb21Db250YWluZXIiLCJib2R5IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxMZWZ0IiwiY3JlYXRlT3ZlcmxheSIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWRkIiwiX2hhbmRsZU9wZW5FbmQiLCJfcmVmMiIsImdldEF0dHJpYnV0ZSIsImNsZWFySW50ZXJ2YWwiLCJnZXRab29tVGFyZ2V0U2l6ZSIsInNjYWxlWSIsInRyYW5zbGF0ZVkiLCJjb21wbGV0ZSIsImxvYWRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDbG9zZUVuZCIsInJlbW92ZUNoaWxkIiwidG9nZ2xlIiwib25lcnJvciIsImNvbnNvbGUiLCJ0b1N0cmluZyIsImF0dGFjaCIsInNjcm9sbE9mZnNldCIsImtleUNvZGUiLCJ3aGljaCIsIkN1c3RvbUV2ZW50IiwiY3VycmVudFNjcm9sbCIsIm5ld09wdGlvbnMiLCJfaGFuZGxlQ2xpY2siLCJvbiIsImdldE9wdGlvbnMiLCJnZXRJbWFnZXMiXSwibWFwcGluZ3MiOiIrUEFDQSxTQUFVQSxFQUFRQyxHQUNLLFlBQW5CLG9CQUFPQyxRQUFQLFlBQUFDLFFBQU9ELFdBQTBDLG9CQUFYRSxPQUF5QkEsT0FBT0YsUUFBVUQsSUFBOEIsbUJBQVhJLFFBQXlCQSxPQUFPQyxJQUFNRCxPQUFPSixHQUFXTSxPQUFPQyxXQUFhUCxJQURuTCxDQUFBLEVBRVcsV0FGVixJQUFBUSxFQUFpQlIsT0FBakJTLFFBQTBCLFNBQUFDLEdBQ3ZCLElBQU9ULElBQUFBLEVBQVAsRUFBQVUsRUFBQUMsVUFBQUMsT0FBQUYsSUFBQSxDQURKLElBRVdHLEVBQUFGLFVBQVdELEdBQ2xCLElBQUEsSUFBQUksS0FBQUQsRUFLVUUsT0FBT0MsVUFBVUMsZUFBZUMsS0FBS0wsRUFBUUMsS0FKbkRQLEVBQVdRLEdBQU9QLEVBQVBNLElBR1gsT0FBS0wsR0FFREEsRUFBQSxTQUFBVSxHQUNELE1BQUEsUUFBQUEsRUFBQUMsU0FOUEMsRUFBQSxTQUFBQyxHQWtCRSxPQUFPQSxHQUFrQyxJQUF0QkEsRUFBU0MsVUFONUJDLEVBQVlKLFNBQVlLLEdBVXhCLE1BQTJDLFVBWDdDQSxF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LEVBUVYsT0FQTW5FLEVBQVE2QyxRQUFBLFNBQUF6RSxHQUNONkIsRUFBSVcsVUFBRVgsT0FBQUEscUJBREE3QixFQUFBK0YsY0FBQUMsRUFBQSxxQkFBQSxDQURWcEUsT0FBQSxDQURGQyxLQUFBQSxRQVNFb0IsRUFBUXNCLEVBQUEzRCxPQUFBLFNBQWlCWixHQUN2QjZFLE9BQWtDM0YsSUFBM0J5RyxFQUFheEcsUUFBVmEsS0FEaEI2QixHQXdOTTRILEdBcE5JLFNBQVlSLEVBQVRsRSxHQUNYLElBQUtGLEVBQVczRixVQUFVQyxPQUFRd0UsUUFBN0JSLElBQTZCUSxVQUFZcEQsR0FBdUJzRCxVQUFPRCxHQUFNQyxHQU1sRixPQUxFRixFQUFBQSxRQUFBLFNBQWtCekUsR0FDbkJjLEVBQUF5RyxpQkFBQSxlQUFBeEYsRUFBQThELEVBQUFGLEtBQ0RELEVBQWdCakIsS0FBQUEsQ0FDZDFDLEtBQU8sZUFBVStDLEVBQ2hCZSxTQUZIQSxFQUdBakIsUUFBVWxELElBRVA2RCxHQTRNRzNELElBMU1JLFNBQVdrSCxFQUFJakQsR0FKekIsSUFBQUYsRUFBQTNGLFVBQUFDLE9BQUEsUUFBQWdFLElBQUFqRSxVQUFBLEdBQUFBLFVBQUEsR0FBQSxHQVVHLE9BSkgwRixFQUFBQSxRQUFlSCxTQUFRekUsR0FDckJBLEVBQVEwSSxvQkFBUixlQUFBekgsRUFBQThELEVBQUFGLEtBQUFELEVBQTBERSxFQUExRGxFLE9BQUEsU0FBQXdHLEdBQ0F0RCxRQUFVVyxFQUFReEQsT0FBQSxlQUFnQkEsR0FBQW1HLEVBQUFyQyxTQUFBaUUsYUFBQWpFLEVBQUFpRSxjQUFsQ25ILEdBdU1HNkgsV0F4Q0dyQixXQUNGLE9BQUF6QyxHQWdJTitELFVBOUhleEMsV0FDUG5GLE9BQUFBLEdBcUNKTyxlQThDZSxXQWpGWDJDLE9BQUFBLEVBQVFzQixXQXFDWnhFLE9BQUFBIiwiZmlsZSI6InBhcnRzL21lZGl1bS16b29tLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBtZWRpdW0tem9vbSAxLjAuNCB8IE1JVCBMaWNlbnNlIHwgaHR0cHM6Ly9naXRodWIuY29tL2ZyYW5jb2lzY2hhbGlmb3VyL21lZGl1bS16b29tICovXG4oZnVuY3Rpb24oZ2xvYmFsLCBmYWN0b3J5KSB7XG4gICAgdHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDogdHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOiB3aW5kb3cubWVkaXVtWm9vbSA9IGZhY3RvcnkoKTtcbiAgfSkodGhpcywgZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0YXJnZXQpIHtcbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfTtcbiAgICB2YXIgaXNTdXBwb3J0ZWQgPSBmdW5jdGlvbiBpc1N1cHBvcnRlZChub2RlKSB7XG4gICAgICByZXR1cm4gbm9kZS50YWdOYW1lID09PSBcIklNR1wiO1xuICAgIH07XG4gICAgdmFyIGlzTm9kZUxpc3QgPSBmdW5jdGlvbiBpc05vZGVMaXN0KHNlbGVjdG9yKSB7XG4gICAgICByZXR1cm4gTm9kZUxpc3QucHJvdG90eXBlLmlzUHJvdG90eXBlT2Yoc2VsZWN0b3IpO1xuICAgIH07XG4gICAgdmFyIGlzTm9kZSA9IGZ1bmN0aW9uIGlzTm9kZShzZWxlY3Rvcikge1xuICAgICAgcmV0dXJuIHNlbGVjdG9yICYmIHNlbGVjdG9yLm5vZGVUeXBlID09PSAxO1xuICAgIH07XG4gICAgdmFyIGlzU3ZnID0gZnVuY3Rpb24gaXNTdmcoaW1hZ2UpIHtcbiAgICAgIHZhciBzb3VyY2UgPSBpbWFnZS5jdXJyZW50U3JjIHx8IGltYWdlLnNyYztcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic3RyKC00KS50b0xvd2VyQ2FzZSgpID09PSBcIi5zdmdcIjtcbiAgICB9O1xuICAgIHZhciBnZXRJbWFnZXNGcm9tU2VsZWN0b3IgPSBmdW5jdGlvbiBnZXRJbWFnZXNGcm9tU2VsZWN0b3Ioc2VsZWN0b3IpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHNlbGVjdG9yKSkge1xuICAgICAgICAgIHJldHVybiBzZWxlY3Rvci5maWx0ZXIoaXNTdXBwb3J0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc05vZGVMaXN0KHNlbGVjdG9yKSkge1xuICAgICAgICAgIHJldHVybiBbXS5zbGljZS5jYWxsKHNlbGVjdG9yKS5maWx0ZXIoaXNTdXBwb3J0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc05vZGUoc2VsZWN0b3IpKSB7XG4gICAgICAgICAgcmV0dXJuIFsgc2VsZWN0b3IgXS5maWx0ZXIoaXNTdXBwb3J0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICByZXR1cm4gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSkuZmlsdGVyKGlzU3VwcG9ydGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW107XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRoZSBwcm92aWRlZCBzZWxlY3RvciBpcyBpbnZhbGlkLlxcblwiICsgXCJFeHBlY3RzIGEgQ1NTIHNlbGVjdG9yLCBhIE5vZGUgZWxlbWVudCwgYSBOb2RlTGlzdCBvciBhbiBhcnJheS5cXG5cIiArIFwiU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZnJhbmNvaXNjaGFsaWZvdXIvbWVkaXVtLXpvb21cIik7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlT3ZlcmxheSA9IGZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXkoYmFja2dyb3VuZCkge1xuICAgICAgdmFyIG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20tb3ZlcmxheVwiKTtcbiAgICAgIG92ZXJsYXkuc3R5bGUuYmFja2dyb3VuZCA9IGJhY2tncm91bmQ7XG4gICAgICByZXR1cm4gb3ZlcmxheTtcbiAgICB9O1xuICAgIHZhciBjbG9uZVRhcmdldCA9IGZ1bmN0aW9uIGNsb25lVGFyZ2V0KHRlbXBsYXRlKSB7XG4gICAgICB2YXIgX3RlbXBsYXRlJGdldEJvdW5kaW5nID0gdGVtcGxhdGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIHRvcCA9IF90ZW1wbGF0ZSRnZXRCb3VuZGluZy50b3AsIGxlZnQgPSBfdGVtcGxhdGUkZ2V0Qm91bmRpbmcubGVmdCwgd2lkdGggPSBfdGVtcGxhdGUkZ2V0Qm91bmRpbmcud2lkdGgsIGhlaWdodCA9IF90ZW1wbGF0ZSRnZXRCb3VuZGluZy5oZWlnaHQ7XG4gICAgICB2YXIgY2xvbmUgPSB0ZW1wbGF0ZS5jbG9uZU5vZGUoKTtcbiAgICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCB8fCAwO1xuICAgICAgdmFyIHNjcm9sbExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0IHx8IDA7XG4gICAgICBjbG9uZS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcbiAgICAgIGNsb25lLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgICAgY2xvbmUuc3R5bGUudG9wID0gdG9wICsgc2Nyb2xsVG9wICsgXCJweFwiO1xuICAgICAgY2xvbmUuc3R5bGUubGVmdCA9IGxlZnQgKyBzY3JvbGxMZWZ0ICsgXCJweFwiO1xuICAgICAgY2xvbmUuc3R5bGUud2lkdGggPSB3aWR0aCArIFwicHhcIjtcbiAgICAgIGNsb25lLnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFwicHhcIjtcbiAgICAgIGNsb25lLnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XG4gICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICB2YXIgY3JlYXRlQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiBjcmVhdGVDdXN0b21FdmVudCh0eXBlLCBwYXJhbXMpIHtcbiAgICAgIHZhciBldmVudFBhcmFtcyA9IF9leHRlbmRzKHtcbiAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgIGNhbmNlbGFibGU6IGZhbHNlLFxuICAgICAgICBkZXRhaWw6IHVuZGVmaW5lZFxuICAgICAgfSwgcGFyYW1zKTtcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDdXN0b21FdmVudCh0eXBlLCBldmVudFBhcmFtcyk7XG4gICAgICB9XG4gICAgICB2YXIgY3VzdG9tRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO1xuICAgICAgY3VzdG9tRXZlbnQuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGV2ZW50UGFyYW1zLmJ1YmJsZXMsIGV2ZW50UGFyYW1zLmNhbmNlbGFibGUsIGV2ZW50UGFyYW1zLmRldGFpbCk7XG4gICAgICByZXR1cm4gY3VzdG9tRXZlbnQ7XG4gICAgfTtcbiAgICB2YXIgbWVkaXVtWm9vbSA9IGZ1bmN0aW9uIG1lZGl1bVpvb20oc2VsZWN0b3IpIHtcbiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICAgIHZhciBQcm9taXNlID0gd2luZG93LlByb21pc2UgfHwgZnVuY3Rpb24gUHJvbWlzZShmbikge1xuICAgICAgICBmdW5jdGlvbiBub29wKCkge31cbiAgICAgICAgZm4obm9vcCwgbm9vcCk7XG4gICAgICB9O1xuICAgICAgdmFyIF9oYW5kbGVDbGljayA9IGZ1bmN0aW9uIF9oYW5kbGVDbGljayhldmVudCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICBpZiAodGFyZ2V0ID09PSBvdmVybGF5KSB7XG4gICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGltYWdlcy5pbmRleE9mKHRhcmdldCkgPT09IC0xKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRvZ2dsZSh7XG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdmFyIF9oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiBfaGFuZGxlU2Nyb2xsKCkge1xuICAgICAgICBpZiAoaXNBbmltYXRpbmcgfHwgIWFjdGl2ZS5vcmlnaW5hbCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudFNjcm9sbCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IDA7XG4gICAgICAgIGlmIChNYXRoLmFicyhzY3JvbGxUb3AgLSBjdXJyZW50U2Nyb2xsKSA+IHpvb21PcHRpb25zLnNjcm9sbE9mZnNldCkge1xuICAgICAgICAgIHNldFRpbWVvdXQoY2xvc2UsIDE1MCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB2YXIgX2hhbmRsZUtleVVwID0gZnVuY3Rpb24gX2hhbmRsZUtleVVwKGV2ZW50KSB7XG4gICAgICAgIGlmICgoZXZlbnQua2V5Q29kZSB8fCBldmVudC53aGljaCkgPT09IDI3KSB7XG4gICAgICAgICAgY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICAgICAgdmFyIG5ld09wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICBpZiAob3B0aW9ucy5iYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgb3ZlcmxheS5zdHlsZS5iYWNrZ3JvdW5kID0gb3B0aW9ucy5iYWNrZ3JvdW5kO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmNvbnRhaW5lciAmJiBvcHRpb25zLmNvbnRhaW5lciBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgIG5ld09wdGlvbnMuY29udGFpbmVyID0gX2V4dGVuZHMoe30sIHpvb21PcHRpb25zLmNvbnRhaW5lciwgb3B0aW9ucy5jb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnRlbXBsYXRlKSB7XG4gICAgICAgICAgdmFyIHRlbXBsYXRlID0gaXNOb2RlKG9wdGlvbnMudGVtcGxhdGUpID8gb3B0aW9ucy50ZW1wbGF0ZSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iob3B0aW9ucy50ZW1wbGF0ZSk7XG4gICAgICAgICAgbmV3T3B0aW9ucy50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgICAgICB9XG4gICAgICAgIHpvb21PcHRpb25zID0gX2V4dGVuZHMoe30sIHpvb21PcHRpb25zLCBuZXdPcHRpb25zKTtcbiAgICAgICAgaW1hZ2VzLmZvckVhY2goZnVuY3Rpb24oaW1hZ2UpIHtcbiAgICAgICAgICBpbWFnZS5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206dXBkYXRlXCIsIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICB6b29tOiB6b29tXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHpvb207XG4gICAgICB9O1xuICAgICAgdmFyIGNsb25lID0gZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICAgICAgcmV0dXJuIG1lZGl1bVpvb20oX2V4dGVuZHMoe30sIHpvb21PcHRpb25zLCBvcHRpb25zKSk7XG4gICAgICB9O1xuICAgICAgdmFyIGF0dGFjaCA9IGZ1bmN0aW9uIGF0dGFjaCgpIHtcbiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHNlbGVjdG9ycyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICAgIHNlbGVjdG9yc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3SW1hZ2VzID0gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbihpbWFnZXNBY2N1bXVsYXRvciwgY3VycmVudFNlbGVjdG9yKSB7XG4gICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChpbWFnZXNBY2N1bXVsYXRvciwgZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yKGN1cnJlbnRTZWxlY3RvcikpO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIG5ld0ltYWdlcy5maWx0ZXIoZnVuY3Rpb24obmV3SW1hZ2UpIHtcbiAgICAgICAgICByZXR1cm4gaW1hZ2VzLmluZGV4T2YobmV3SW1hZ2UpID09PSAtMTtcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbihuZXdJbWFnZSkge1xuICAgICAgICAgIGltYWdlcy5wdXNoKG5ld0ltYWdlKTtcbiAgICAgICAgICBuZXdJbWFnZS5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20taW1hZ2VcIik7XG4gICAgICAgIH0pO1xuICAgICAgICBldmVudExpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKF9yZWYpIHtcbiAgICAgICAgICB2YXIgdHlwZSA9IF9yZWYudHlwZSwgbGlzdGVuZXIgPSBfcmVmLmxpc3RlbmVyLCBvcHRpb25zID0gX3JlZi5vcHRpb25zO1xuICAgICAgICAgIG5ld0ltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKGltYWdlKSB7XG4gICAgICAgICAgICBpbWFnZS5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB6b29tO1xuICAgICAgfTtcbiAgICAgIHZhciBkZXRhY2ggPSBmdW5jdGlvbiBkZXRhY2goKSB7XG4gICAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgc2VsZWN0b3JzID0gQXJyYXkoX2xlbjIpLCBfa2V5MiA9IDA7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgICBzZWxlY3RvcnNbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aXZlLnpvb21lZCkge1xuICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlc1RvRGV0YWNoID0gc2VsZWN0b3JzLmxlbmd0aCA+IDAgPyBzZWxlY3RvcnMucmVkdWNlKGZ1bmN0aW9uKGltYWdlc0FjY3VtdWxhdG9yLCBjdXJyZW50U2VsZWN0b3IpIHtcbiAgICAgICAgICByZXR1cm4gW10uY29uY2F0KGltYWdlc0FjY3VtdWxhdG9yLCBnZXRJbWFnZXNGcm9tU2VsZWN0b3IoY3VycmVudFNlbGVjdG9yKSk7XG4gICAgICAgIH0sIFtdKSA6IGltYWdlcztcbiAgICAgICAgaW1hZ2VzVG9EZXRhY2guZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICAgIGltYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJtZWRpdW0tem9vbS1pbWFnZVwiKTtcbiAgICAgICAgICBpbWFnZS5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206ZGV0YWNoXCIsIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICB6b29tOiB6b29tXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgaW1hZ2VzID0gaW1hZ2VzLmZpbHRlcihmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICAgIHJldHVybiBpbWFnZXNUb0RldGFjaC5pbmRleE9mKGltYWdlKSA9PT0gLTE7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gem9vbTtcbiAgICAgIH07XG4gICAgICB2YXIgb24gPSBmdW5jdGlvbiBvbih0eXBlLCBsaXN0ZW5lcikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307XG4gICAgICAgIGltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKGltYWdlKSB7XG4gICAgICAgICAgaW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcIm1lZGl1bS16b29tOlwiICsgdHlwZSwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgICAgICB9KTtcbiAgICAgICAgZXZlbnRMaXN0ZW5lcnMucHVzaCh7XG4gICAgICAgICAgdHlwZTogXCJtZWRpdW0tem9vbTpcIiArIHR5cGUsXG4gICAgICAgICAgbGlzdGVuZXI6IGxpc3RlbmVyLFxuICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB6b29tO1xuICAgICAgfTtcbiAgICAgIHZhciBvZmYgPSBmdW5jdGlvbiBvZmYodHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICAgICAgICBpbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICAgIGltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZWRpdW0tem9vbTpcIiArIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJzID0gZXZlbnRMaXN0ZW5lcnMuZmlsdGVyKGZ1bmN0aW9uKGV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICByZXR1cm4gIShldmVudExpc3RlbmVyLnR5cGUgPT09IFwibWVkaXVtLXpvb206XCIgKyB0eXBlICYmIGV2ZW50TGlzdGVuZXIubGlzdGVuZXIudG9TdHJpbmcoKSA9PT0gbGlzdGVuZXIudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gem9vbTtcbiAgICAgIH07XG4gICAgICB2YXIgb3BlbiA9IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICAgIHZhciBfcmVmMiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sIHRhcmdldCA9IF9yZWYyLnRhcmdldDtcbiAgICAgICAgdmFyIF9hbmltYXRlID0gZnVuY3Rpb24gX2FuaW1hdGUoKSB7XG4gICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHtcbiAgICAgICAgICAgIHdpZHRoOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQsXG4gICAgICAgICAgICBsZWZ0OiAwLFxuICAgICAgICAgICAgdG9wOiAwLFxuICAgICAgICAgICAgcmlnaHQ6IDAsXG4gICAgICAgICAgICBib3R0b206IDBcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciB2aWV3cG9ydFdpZHRoID0gdm9pZCAwO1xuICAgICAgICAgIHZhciB2aWV3cG9ydEhlaWdodCA9IHZvaWQgMDtcbiAgICAgICAgICBpZiAoem9vbU9wdGlvbnMuY29udGFpbmVyKSB7XG4gICAgICAgICAgICBpZiAoem9vbU9wdGlvbnMuY29udGFpbmVyIGluc3RhbmNlb2YgT2JqZWN0KSB7XG4gICAgICAgICAgICAgIGNvbnRhaW5lciA9IF9leHRlbmRzKHt9LCBjb250YWluZXIsIHpvb21PcHRpb25zLmNvbnRhaW5lcik7XG4gICAgICAgICAgICAgIHZpZXdwb3J0V2lkdGggPSBjb250YWluZXIud2lkdGggLSBjb250YWluZXIubGVmdCAtIGNvbnRhaW5lci5yaWdodCAtIHpvb21PcHRpb25zLm1hcmdpbiAqIDI7XG4gICAgICAgICAgICAgIHZpZXdwb3J0SGVpZ2h0ID0gY29udGFpbmVyLmhlaWdodCAtIGNvbnRhaW5lci50b3AgLSBjb250YWluZXIuYm90dG9tIC0gem9vbU9wdGlvbnMubWFyZ2luICogMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciB6b29tQ29udGFpbmVyID0gaXNOb2RlKHpvb21PcHRpb25zLmNvbnRhaW5lcikgPyB6b29tT3B0aW9ucy5jb250YWluZXIgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHpvb21PcHRpb25zLmNvbnRhaW5lcik7XG4gICAgICAgICAgICAgIHZhciBfem9vbUNvbnRhaW5lciRnZXRCb3UgPSB6b29tQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBfd2lkdGggPSBfem9vbUNvbnRhaW5lciRnZXRCb3Uud2lkdGgsIF9oZWlnaHQgPSBfem9vbUNvbnRhaW5lciRnZXRCb3UuaGVpZ2h0LCBfbGVmdCA9IF96b29tQ29udGFpbmVyJGdldEJvdS5sZWZ0LCBfdG9wID0gX3pvb21Db250YWluZXIkZ2V0Qm91LnRvcDtcbiAgICAgICAgICAgICAgY29udGFpbmVyID0gX2V4dGVuZHMoe30sIGNvbnRhaW5lciwge1xuICAgICAgICAgICAgICAgIHdpZHRoOiBfd2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBfaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGxlZnQ6IF9sZWZ0LFxuICAgICAgICAgICAgICAgIHRvcDogX3RvcFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdmlld3BvcnRXaWR0aCA9IHZpZXdwb3J0V2lkdGggfHwgY29udGFpbmVyLndpZHRoIC0gem9vbU9wdGlvbnMubWFyZ2luICogMjtcbiAgICAgICAgICB2aWV3cG9ydEhlaWdodCA9IHZpZXdwb3J0SGVpZ2h0IHx8IGNvbnRhaW5lci5oZWlnaHQgLSB6b29tT3B0aW9ucy5tYXJnaW4gKiAyO1xuICAgICAgICAgIHZhciB6b29tVGFyZ2V0ID0gYWN0aXZlLnpvb21lZEhkIHx8IGFjdGl2ZS5vcmlnaW5hbDtcbiAgICAgICAgICB2YXIgbmF0dXJhbFdpZHRoID0gaXNTdmcoem9vbVRhcmdldCkgPyB2aWV3cG9ydFdpZHRoIDogem9vbVRhcmdldC5uYXR1cmFsV2lkdGggfHwgdmlld3BvcnRXaWR0aDtcbiAgICAgICAgICB2YXIgbmF0dXJhbEhlaWdodCA9IGlzU3ZnKHpvb21UYXJnZXQpID8gdmlld3BvcnRIZWlnaHQgOiB6b29tVGFyZ2V0Lm5hdHVyYWxIZWlnaHQgfHwgdmlld3BvcnRIZWlnaHQ7XG4gICAgICAgICAgdmFyIF96b29tVGFyZ2V0JGdldEJvdW5kaSA9IHpvb21UYXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIHRvcCA9IF96b29tVGFyZ2V0JGdldEJvdW5kaS50b3AsIGxlZnQgPSBfem9vbVRhcmdldCRnZXRCb3VuZGkubGVmdCwgd2lkdGggPSBfem9vbVRhcmdldCRnZXRCb3VuZGkud2lkdGgsIGhlaWdodCA9IF96b29tVGFyZ2V0JGdldEJvdW5kaS5oZWlnaHQ7XG4gICAgICAgICAgdmFyIHNjYWxlWCA9IE1hdGgubWluKG5hdHVyYWxXaWR0aCwgdmlld3BvcnRXaWR0aCkgLyB3aWR0aDtcbiAgICAgICAgICB2YXIgc2NhbGVZID0gTWF0aC5taW4obmF0dXJhbEhlaWdodCwgdmlld3BvcnRIZWlnaHQpIC8gaGVpZ2h0O1xuICAgICAgICAgIHZhciBzY2FsZSA9IE1hdGgubWluKHNjYWxlWCwgc2NhbGVZKTtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRlWCA9ICgtbGVmdCArICh2aWV3cG9ydFdpZHRoIC0gd2lkdGgpIC8gMiArIHpvb21PcHRpb25zLm1hcmdpbiArIGNvbnRhaW5lci5sZWZ0KSAvIHNjYWxlO1xuICAgICAgICAgIHZhciB0cmFuc2xhdGVZID0gKC10b3AgKyAodmlld3BvcnRIZWlnaHQgLSBoZWlnaHQpIC8gMiArIHpvb21PcHRpb25zLm1hcmdpbiArIGNvbnRhaW5lci50b3ApIC8gc2NhbGU7XG4gICAgICAgICAgdmFyIHRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBzY2FsZSArIFwiKSB0cmFuc2xhdGUzZChcIiArIHRyYW5zbGF0ZVggKyBcInB4LCBcIiArIHRyYW5zbGF0ZVkgKyBcInB4LCAwKVwiO1xuICAgICAgICAgIGFjdGl2ZS56b29tZWQuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgICAgICAgIGlmIChhY3RpdmUuem9vbWVkSGQpIHtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5zdHlsZS50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICAgIGlmICh0YXJnZXQgJiYgaW1hZ2VzLmluZGV4T2YodGFyZ2V0KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBfaGFuZGxlT3BlbkVuZCA9IGZ1bmN0aW9uIF9oYW5kbGVPcGVuRW5kKCkge1xuICAgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgX2hhbmRsZU9wZW5FbmQpO1xuICAgICAgICAgICAgYWN0aXZlLm9yaWdpbmFsLmRpc3BhdGNoRXZlbnQoY3JlYXRlQ3VzdG9tRXZlbnQoXCJtZWRpdW0tem9vbTpvcGVuZWRcIiwge1xuICAgICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgICB6b29tOiB6b29tXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpZiAoYWN0aXZlLnpvb21lZCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh6b29tKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgYWN0aXZlLm9yaWdpbmFsID0gdGFyZ2V0O1xuICAgICAgICAgIH0gZWxzZSBpZiAoaW1hZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBfaW1hZ2VzID0gaW1hZ2VzO1xuICAgICAgICAgICAgYWN0aXZlLm9yaWdpbmFsID0gX2ltYWdlc1swXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh6b29tKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWN0aXZlLm9yaWdpbmFsLmRpc3BhdGNoRXZlbnQoY3JlYXRlQ3VzdG9tRXZlbnQoXCJtZWRpdW0tem9vbTpvcGVuXCIsIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICB6b29tOiB6b29tXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IDA7XG4gICAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuICAgICAgICAgIGFjdGl2ZS56b29tZWQgPSBjbG9uZVRhcmdldChhY3RpdmUub3JpZ2luYWwpO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7XG4gICAgICAgICAgaWYgKHpvb21PcHRpb25zLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBpc05vZGUoem9vbU9wdGlvbnMudGVtcGxhdGUpID8gem9vbU9wdGlvbnMudGVtcGxhdGUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHpvb21PcHRpb25zLnRlbXBsYXRlKTtcbiAgICAgICAgICAgIGFjdGl2ZS50ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBhY3RpdmUudGVtcGxhdGUuYXBwZW5kQ2hpbGQodGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhY3RpdmUudGVtcGxhdGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFjdGl2ZS56b29tZWQpO1xuICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJtZWRpdW0tem9vbS0tb3BlbmVkXCIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbC5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20taW1hZ2UtLWhpZGRlblwiKTtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkLmNsYXNzTGlzdC5hZGQoXCJtZWRpdW0tem9vbS1pbWFnZS0tb3BlbmVkXCIpO1xuICAgICAgICAgIGFjdGl2ZS56b29tZWQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsb3NlKTtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIF9oYW5kbGVPcGVuRW5kKTtcbiAgICAgICAgICBpZiAoYWN0aXZlLm9yaWdpbmFsLmdldEF0dHJpYnV0ZShcImRhdGEtem9vbS1zcmNcIikpIHtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZCA9IGFjdGl2ZS56b29tZWQuY2xvbmVOb2RlKCk7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQucmVtb3ZlQXR0cmlidXRlKFwic3Jjc2V0XCIpO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLnJlbW92ZUF0dHJpYnV0ZShcInNpemVzXCIpO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLnNyYyA9IGFjdGl2ZS56b29tZWQuZ2V0QXR0cmlidXRlKFwiZGF0YS16b29tLXNyY1wiKTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoZ2V0Wm9vbVRhcmdldFNpemUpO1xuICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJVbmFibGUgdG8gcmVhY2ggdGhlIHpvb20gaW1hZ2UgdGFyZ2V0IFwiICsgYWN0aXZlLnpvb21lZEhkLnNyYyk7XG4gICAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZCA9IG51bGw7XG4gICAgICAgICAgICAgIF9hbmltYXRlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGdldFpvb21UYXJnZXRTaXplID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGlmIChhY3RpdmUuem9vbWVkSGQuY29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGdldFpvb21UYXJnZXRTaXplKTtcbiAgICAgICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQuY2xhc3NMaXN0LmFkZChcIm1lZGl1bS16b29tLWltYWdlLS1vcGVuZWRcIik7XG4gICAgICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhY3RpdmUuem9vbWVkSGQpO1xuICAgICAgICAgICAgICAgIF9hbmltYXRlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGl2ZS5vcmlnaW5hbC5oYXNBdHRyaWJ1dGUoXCJzcmNzZXRcIikpIHtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZCA9IGFjdGl2ZS56b29tZWQuY2xvbmVOb2RlKCk7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQucmVtb3ZlQXR0cmlidXRlKFwic2l6ZXNcIik7XG4gICAgICAgICAgICB2YXIgbG9hZEV2ZW50TGlzdGVuZXIgPSBhY3RpdmUuem9vbWVkSGQuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLCBsb2FkRXZlbnRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20taW1hZ2UtLW9wZW5lZFwiKTtcbiAgICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZSk7XG4gICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYWN0aXZlLnpvb21lZEhkKTtcbiAgICAgICAgICAgICAgX2FuaW1hdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfYW5pbWF0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdmFyIGNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgICAgaWYgKGlzQW5pbWF0aW5nIHx8ICFhY3RpdmUub3JpZ2luYWwpIHtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBfaGFuZGxlQ2xvc2VFbmQgPSBmdW5jdGlvbiBfaGFuZGxlQ2xvc2VFbmQoKSB7XG4gICAgICAgICAgICBhY3RpdmUub3JpZ2luYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1lZGl1bS16b29tLWltYWdlLS1oaWRkZW5cIik7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFjdGl2ZS56b29tZWQpO1xuICAgICAgICAgICAgaWYgKGFjdGl2ZS56b29tZWRIZCkge1xuICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFjdGl2ZS56b29tZWRIZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZC5jbGFzc0xpc3QucmVtb3ZlKFwibWVkaXVtLXpvb20taW1hZ2UtLW9wZW5lZFwiKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmUudGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhY3RpdmUudGVtcGxhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgX2hhbmRsZUNsb3NlRW5kKTtcbiAgICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206Y2xvc2VkXCIsIHtcbiAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgem9vbTogem9vbVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBhY3RpdmUub3JpZ2luYWwgPSBudWxsO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZCA9IG51bGw7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQgPSBudWxsO1xuICAgICAgICAgICAgYWN0aXZlLnRlbXBsYXRlID0gbnVsbDtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwibWVkaXVtLXpvb20tLW9wZW5lZFwiKTtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkLnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XG4gICAgICAgICAgaWYgKGFjdGl2ZS56b29tZWRIZCkge1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhY3RpdmUudGVtcGxhdGUpIHtcbiAgICAgICAgICAgIGFjdGl2ZS50ZW1wbGF0ZS5zdHlsZS50cmFuc2l0aW9uID0gXCJvcGFjaXR5IDE1MG1zXCI7XG4gICAgICAgICAgICBhY3RpdmUudGVtcGxhdGUuc3R5bGUub3BhY2l0eSA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206Y2xvc2VcIiwge1xuICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgIHpvb206IHpvb21cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgYWN0aXZlLnpvb21lZC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBfaGFuZGxlQ2xvc2VFbmQpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgICB2YXIgdG9nZ2xlID0gZnVuY3Rpb24gdG9nZ2xlKCkge1xuICAgICAgICB2YXIgX3JlZjMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9LCB0YXJnZXQgPSBfcmVmMy50YXJnZXQ7XG4gICAgICAgIGlmIChhY3RpdmUub3JpZ2luYWwpIHtcbiAgICAgICAgICByZXR1cm4gY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3Blbih7XG4gICAgICAgICAgdGFyZ2V0OiB0YXJnZXRcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdmFyIGdldE9wdGlvbnMgPSBmdW5jdGlvbiBnZXRPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4gem9vbU9wdGlvbnM7XG4gICAgICB9O1xuICAgICAgdmFyIGdldEltYWdlcyA9IGZ1bmN0aW9uIGdldEltYWdlcygpIHtcbiAgICAgICAgcmV0dXJuIGltYWdlcztcbiAgICAgIH07XG4gICAgICB2YXIgZ2V0Wm9vbWVkSW1hZ2UgPSBmdW5jdGlvbiBnZXRab29tZWRJbWFnZSgpIHtcbiAgICAgICAgcmV0dXJuIGFjdGl2ZS5vcmlnaW5hbDtcbiAgICAgIH07XG4gICAgICB2YXIgaW1hZ2VzID0gW107XG4gICAgICB2YXIgZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgICAgIHZhciBpc0FuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IDA7XG4gICAgICB2YXIgem9vbU9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgdmFyIGFjdGl2ZSA9IHtcbiAgICAgICAgb3JpZ2luYWw6IG51bGwsXG4gICAgICAgIHpvb21lZDogbnVsbCxcbiAgICAgICAgem9vbWVkSGQ6IG51bGwsXG4gICAgICAgIHRlbXBsYXRlOiBudWxsXG4gICAgICB9O1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChzZWxlY3RvcikgPT09IFwiW29iamVjdCBPYmplY3RdXCIpIHtcbiAgICAgICAgem9vbU9wdGlvbnMgPSBzZWxlY3RvcjtcbiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0b3IgfHwgdHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGF0dGFjaChzZWxlY3Rvcik7XG4gICAgICB9XG4gICAgICB6b29tT3B0aW9ucyA9IF9leHRlbmRzKHtcbiAgICAgICAgbWFyZ2luOiAwLFxuICAgICAgICBiYWNrZ3JvdW5kOiBcIiNmZmZcIixcbiAgICAgICAgc2Nyb2xsT2Zmc2V0OiA0MCxcbiAgICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgICB0ZW1wbGF0ZTogbnVsbFxuICAgICAgfSwgem9vbU9wdGlvbnMpO1xuICAgICAgdmFyIG92ZXJsYXkgPSBjcmVhdGVPdmVybGF5KHpvb21PcHRpb25zLmJhY2tncm91bmQpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF9oYW5kbGVDbGljayk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgX2hhbmRsZUtleVVwKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgX2hhbmRsZVNjcm9sbCk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBjbG9zZSk7XG4gICAgICB2YXIgem9vbSA9IHtcbiAgICAgICAgb3Blbjogb3BlbixcbiAgICAgICAgY2xvc2U6IGNsb3NlLFxuICAgICAgICB0b2dnbGU6IHRvZ2dsZSxcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIGNsb25lOiBjbG9uZSxcbiAgICAgICAgYXR0YWNoOiBhdHRhY2gsXG4gICAgICAgIGRldGFjaDogZGV0YWNoLFxuICAgICAgICBvbjogb24sXG4gICAgICAgIG9mZjogb2ZmLFxuICAgICAgICBnZXRPcHRpb25zOiBnZXRPcHRpb25zLFxuICAgICAgICBnZXRJbWFnZXM6IGdldEltYWdlcyxcbiAgICAgICAgZ2V0Wm9vbWVkSW1hZ2U6IGdldFpvb21lZEltYWdlXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHpvb207XG4gICAgfTtcbiAgICBmdW5jdGlvbiBzdHlsZUluamVjdChjc3MsIHJlZikge1xuICAgICAgaWYgKHJlZiA9PT0gdm9pZCAwKSByZWYgPSB7fTtcbiAgICAgIHZhciBpbnNlcnRBdCA9IHJlZi5pbnNlcnRBdDtcbiAgICAgIGlmICghY3NzIHx8IHR5cGVvZiBkb2N1bWVudCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgaGVhZCA9IGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO1xuICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgc3R5bGUudHlwZSA9IFwidGV4dC9jc3NcIjtcbiAgICAgIGlmIChpbnNlcnRBdCA9PT0gXCJ0b3BcIikge1xuICAgICAgICBpZiAoaGVhZC5maXJzdENoaWxkKSB7XG4gICAgICAgICAgaGVhZC5pbnNlcnRCZWZvcmUoc3R5bGUsIGhlYWQuZmlyc3RDaGlsZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgfVxuICAgICAgaWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcbiAgICAgICAgc3R5bGUuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBjc3MgPSBcIi5tZWRpdW0tem9vbS1vdmVybGF5e3Bvc2l0aW9uOmZpeGVkO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDowO29wYWNpdHk6MDt0cmFuc2l0aW9uOm9wYWNpdHkgLjNzO3dpbGwtY2hhbmdlOm9wYWNpdHl9Lm1lZGl1bS16b29tLS1vcGVuZWQgLm1lZGl1bS16b29tLW92ZXJsYXl7Y3Vyc29yOnBvaW50ZXI7Y3Vyc29yOnpvb20tb3V0O29wYWNpdHk6MX0ubWVkaXVtLXpvb20taW1hZ2V7Y3Vyc29yOnBvaW50ZXI7Y3Vyc29yOnpvb20taW47dHJhbnNpdGlvbjp0cmFuc2Zvcm0gLjNzIGN1YmljLWJlemllciguMiwwLC4yLDEpfS5tZWRpdW0tem9vbS1pbWFnZS0taGlkZGVue3Zpc2liaWxpdHk6aGlkZGVufS5tZWRpdW0tem9vbS1pbWFnZS0tb3BlbmVke3Bvc2l0aW9uOnJlbGF0aXZlO2N1cnNvcjpwb2ludGVyO2N1cnNvcjp6b29tLW91dDt3aWxsLWNoYW5nZTp0cmFuc2Zvcm19XCI7XG4gICAgc3R5bGVJbmplY3QoY3NzKTtcbiAgICByZXR1cm4gbWVkaXVtWm9vbTtcbiAgfSk7Il19
