"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):window.mediumZoom=t()}(0,function(){var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t=function(e){return"IMG"===e.tagName},o=function(e){return e&&1===e.nodeType},n=function(e){return".svg"===(e.currentSrc||e.src).substr(-4).toLowerCase()},i=function(e){try{return Array.isArray(e)?e.filter(t):function(e){return NodeList.prototype.isPrototypeOf(e)}(e)?[].slice.call(e).filter(t):o(e)?[e].filter(t):"string"==typeof e?[].slice.call(document.querySelectorAll(e)).filter(t):[]}catch(e){throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},r=function(t,o){var n=e({bubbles:!1,cancelable:!1,detail:void 0},o);if("function"==typeof window.CustomEvent)return new CustomEvent(t,n);var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),i};return function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===o&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}"),function t(d){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=window.Promise||function(e){function t(){}e(t,t)},l=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];var n=t.reduce(function(e,t){return[].concat(e,i(t))},[]);return n.filter(function(e){return-1===f.indexOf(e)}).forEach(function(e){f.push(e),e.classList.add("medium-zoom-image")}),p.forEach(function(e){var t=e.type,o=e.listener,i=e.options;n.forEach(function(e){e.addEventListener(t,o,i)})}),b},m=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target,i=function(){var t={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},i=void 0,r=void 0;if(y.container)if(y.container instanceof Object)i=(t=e({},t,y.container)).width-t.left-t.right-2*y.margin,r=t.height-t.top-t.bottom-2*y.margin;else{var d=(o(y.container)?y.container:document.querySelector(y.container)).getBoundingClientRect(),a=d.width,c=d.height,l=d.left,m=d.top;t=e({},t,{width:a,height:c,left:l,top:m})}i=i||t.width-2*y.margin,r=r||t.height-2*y.margin;var s=h.zoomedHd||h.original,u=n(s)?i:s.naturalWidth||i,f=n(s)?r:s.naturalHeight||r,p=s.getBoundingClientRect(),v=p.top,g=p.left,z=p.width,b=p.height,E=Math.min(u,i)/z,w=Math.min(f,r)/b,L=Math.min(E,w),S="scale("+L+") translate3d("+((i-z)/2-g+y.margin+t.left)/L+"px, "+((r-b)/2-v+y.margin+t.top)/L+"px, 0)";h.zoomed.style.transform=S,h.zoomedHd&&(h.zoomedHd.style.transform=S)};return new c(function(e){if(t&&-1===f.indexOf(t))e(b);else if(h.zoomed)e(b);else{if(t)h.original=t;else{if(!(f.length>0))return void e(b);var n=f;h.original=n[0]}if(h.original.dispatchEvent(r("medium-zoom:open",{detail:{zoom:b}})),g=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,v=!0,h.zoomed=function(e){var t=e.getBoundingClientRect(),o=t.top,n=t.left,i=t.width,r=t.height,d=e.cloneNode(),a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,c=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return d.removeAttribute("id"),d.style.position="absolute",d.style.top=o+a+"px",d.style.left=n+c+"px",d.style.width=i+"px",d.style.height=r+"px",d.style.transform="",d}(h.original),document.body.appendChild(z),y.template){var d=o(y.template)?y.template:document.querySelector(y.template);h.template=document.createElement("div"),h.template.appendChild(d.content.cloneNode(!0)),document.body.appendChild(h.template)}if(document.body.appendChild(h.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),h.original.classList.add("medium-zoom-image--hidden"),h.zoomed.classList.add("medium-zoom-image--opened"),h.zoomed.addEventListener("click",s),h.zoomed.addEventListener("transitionend",function t(){v=!1,h.zoomed.removeEventListener("transitionend",t),h.original.dispatchEvent(r("medium-zoom:opened",{detail:{zoom:b}})),e(b)}),h.original.getAttribute("data-zoom-src")){h.zoomedHd=h.zoomed.cloneNode(),h.zoomedHd.removeAttribute("srcset"),h.zoomedHd.removeAttribute("sizes"),h.zoomedHd.src=h.zoomed.getAttribute("data-zoom-src"),h.zoomedHd.onerror=function(){clearInterval(a),console.warn("Unable to reach the zoom image target "+h.zoomedHd.src),h.zoomedHd=null,i()};var a=setInterval(function(){h.zoomedHd.complete&&(clearInterval(a),h.zoomedHd.classList.add("medium-zoom-image--opened"),h.zoomedHd.addEventListener("click",s),document.body.appendChild(h.zoomedHd),i())},10)}else if(h.original.hasAttribute("srcset")){h.zoomedHd=h.zoomed.cloneNode(),h.zoomedHd.removeAttribute("sizes");var c=h.zoomedHd.addEventListener("load",function(){h.zoomedHd.removeEventListener("load",c),h.zoomedHd.classList.add("medium-zoom-image--opened"),h.zoomedHd.addEventListener("click",s),document.body.appendChild(h.zoomedHd),i()})}else i()}})},s=function(){return new c(function(e){!v&&h.original?(v=!0,document.body.classList.remove("medium-zoom--opened"),h.zoomed.style.transform="",h.zoomedHd&&(h.zoomedHd.style.transform=""),h.template&&(h.template.style.transition="opacity 150ms",h.template.style.opacity=0),h.original.dispatchEvent(r("medium-zoom:close",{detail:{zoom:b}})),h.zoomed.addEventListener("transitionend",function t(){h.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(h.zoomed),h.zoomedHd&&document.body.removeChild(h.zoomedHd),document.body.removeChild(z),h.zoomed.classList.remove("medium-zoom-image--opened"),h.template&&document.body.removeChild(h.template),v=!1,h.zoomed.removeEventListener("transitionend",t),h.original.dispatchEvent(r("medium-zoom:closed",{detail:{zoom:b}})),h.original=null,h.zoomed=null,h.zoomedHd=null,h.template=null,e(b)})):e(b)})},u=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).target;return h.original?s():m({target:e})},f=[],p=[],v=!1,g=0,y=a,h={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(d)?y=d:(d||"string"==typeof d)&&l(d);var z=function(e){var t=document.createElement("div");return t.classList.add("medium-zoom-overlay"),t.style.background=e,t}((y=e({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},y)).background);document.addEventListener("click",function(e){var t=e.target;t!==z?-1!==f.indexOf(t)&&u({target:t}):s()}),document.addEventListener("keyup",function(e){27===(e.keyCode||e.which)&&s()}),document.addEventListener("scroll",function(){if(!v&&h.original){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(g-e)>y.scrollOffset&&setTimeout(s,150)}}),window.addEventListener("resize",s);var b={open:m,close:s,toggle:u,update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t;if(t.background&&(z.style.background=t.background),t.container&&t.container instanceof Object&&(n.container=e({},y.container,t.container)),t.template){var i=o(t.template)?t.template:document.querySelector(t.template);n.template=i}return y=e({},y,n),f.forEach(function(e){e.dispatchEvent(r("medium-zoom:update",{detail:{zoom:b}}))}),b},clone:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(e({},y,o))},attach:l,detach:function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];h.zoomed&&s();var n=t.length>0?t.reduce(function(e,t){return[].concat(e,i(t))},[]):f;return n.forEach(function(e){e.classList.remove("medium-zoom-image"),e.dispatchEvent(r("medium-zoom:detach",{detail:{zoom:b}}))}),f=f.filter(function(e){return-1===n.indexOf(e)}),b},on:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(n){n.addEventListener("medium-zoom:"+e,t,o)}),p.push({type:"medium-zoom:"+e,listener:t,options:o}),b},off:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.forEach(function(n){n.removeEventListener("medium-zoom:"+e,t,o)}),p=p.filter(function(o){return!(o.type==="medium-zoom:"+e&&o.listener.toString()===t.toString())}),b},getOptions:function(){return y},getImages:function(){return f},getZoomedImage:function(){return h.original}};return b}}),function(){var e=document.querySelector(".other-services__swiper"),t=document.querySelector(".other-services__list"),o=parseInt(getComputedStyle(e).width),n=parseInt(getComputedStyle(t).width);window.onload=function(){var t=getComputedStyle(e).height;e.style.height="".concat(parseInt(t)+40,"px")},t.style.marginLeft="0px",e.addEventListener("mousedown",function(i){e.addEventListener("mouseleave",function(){e.removeEventListener("mousemove",m)}),e.addEventListener("mouseup",function i(c){if(e.removeEventListener("mousemove",m),l>=100){var s=(l=l>n-o?n-o:l)/1.5,u=c.pageX;switch(r=u<a?"left":"right",d=parseInt(t.style.marginLeft),r){case"left":if(-d>=n-o)return;s=s>n-o+d?n-o+d:s,t.style.transition="all 0.35s",t.style.marginLeft="".concat(d-s,"px");break;case"right":if(d>=0)return;s=s>-d?-d:s,t.style.transition="all 0.35s",t.style.marginLeft="".concat(d+s,"px")}setTimeout(function(){t.style.transition="all 0s"},250),e.removeEventListener("mouseup",i)}});var r,d,a=i.pageX,c=i.pageX,l=0;function m(e){var i=e.pageX,a=Math.abs(c-i);switch(d=parseInt(t.style.marginLeft),i<c?r="left":i>c?r="right":(i=c)&&(r=r),r){case"left":if(-d>=n-o)return;t.style.marginLeft="".concat(d-a,"px");break;case"right":if(d>=0)return;t.style.marginLeft="".concat(d+a,"px")}l+=a,c=i}e.addEventListener("mousemove",m)})}(),function(){var e,t=document.querySelectorAll("*[data-modal-target]"),o=document.querySelectorAll("*[data-modal-close]"),n=function(t){var o=t.currentTarget,n=o.dataset.modalTarget,d=document.getElementById(n);void 0!==e&&a(e),"service-example"===n&&function(e,t){var o=e.parentElement.querySelector(".what-you-get__item-title").textContent.replace(/\s+/g," ").trim(),n=t.querySelector(".modal__title"),i=e.dataset.modalServiceExampleImage,r=t.querySelector(".modal__image");n.textContent=o,r.src=i}(o,d),e=n,d.classList.add("visible"),document.querySelector("body").classList.add("fixed"),window.addEventListener("click",r),window.addEventListener("keydown",i);var c=d.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])'),l=c[0],m=c[c.length-1];d.addEventListener("keydown",function(e){"Tab"!==e.key&&9!==e.keyCode||(e.shiftKey?document.activeElement===l&&(e.preventDefault(),m.focus()):document.activeElement===m&&(e.preventDefault(),l.focus()))})},i=function(t){"Escape"===t.key&&a(e)},r=function(t){t.target.classList.contains("modal__bg")&&a(e)},d=function(e){return a(e.currentTarget.dataset.modalClose)},a=function(e){document.getElementById(e).classList.remove("visible"),document.querySelector("body").classList.remove("fixed"),window.removeEventListener("click",r),window.removeEventListener("keydown",i)};o.forEach(function(e){return e.addEventListener("click",d)}),window.modals={openModalWindow:n,closeModalWindow:a},function(){var e=!0,o=!1,i=void 0;try{for(var r,d=t[Symbol.iterator]();!(e=(r=d.next()).done);e=!0)r.value.addEventListener("click",n)}catch(e){o=!0,i=e}finally{try{e||null==d.return||d.return()}finally{if(o)throw i}}}()}(),function(){var e=document.querySelectorAll("*[data-scroll-link]"),t=function(e){var t=e.target,o=document.getElementById(t.dataset.scrollLink);o&&o.scrollIntoView({behavior:"smooth"})};Boolean(e)&&e.forEach(function(e){return e.addEventListener("click",t)})}(),function(){document.addEventListener("DOMContentLoaded",function(){[].slice.call(document.querySelectorAll("picture.lazy")).forEach(function(e){var t=e,o=t.querySelector('[type="image/webp"]'),n=t.querySelector("img");o.srcset=o.dataset.src,n.src=n.dataset.src,t.setAttribute("data-picture","opacity-1"),t.classList.remove("lazy")})})}(),document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll(".smooth-display-block"));if("IntersectionObserver"in window){var t=new IntersectionObserver(function(e,o){e.forEach(function(e){if(e.isIntersecting){var o=e.target;o.setAttribute("data-smooth-display-block","active"),t.unobserve(o)}})});e.forEach(function(e){t.observe(e)})}}),mediumZoom("[data-zoomable]");
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJnbG9iYWwiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIl90eXBlb2YiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJ3aW5kb3ciLCJtZWRpdW1ab29tIiwiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwicHJvdG90eXBlIiwiY2FsbCIsImtleSIsImlzU3VwcG9ydGVkIiwibm9kZSIsInRhZ05hbWUiLCJzZWxlY3RvciIsIm5vZGVUeXBlIiwiaXNTdmciLCJpbWFnZSIsImN1cnJlbnRTcmMiLCJpc1Byb3RvdHlwZU9mIiwiZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yIiwiaXNOb2RlIiwiZmlsdGVyIiwiTm9kZUxpc3QiLCJpc05vZGVMaXN0IiwiaXNBcnJheSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlcnIiLCJjcmVhdGVDdXN0b21FdmVudCIsInR5cGUiLCJwYXJhbXMiLCJldmVudFBhcmFtcyIsImNsb25lVGFyZ2V0IiwiX3RlbXBsYXRlJGdldEJvdW5kaW5nIiwidG9wIiwibGVmdCIsIndpZHRoIiwiaGVpZ2h0IiwiY2xvbmUiLCJkb2N1bWVudCIsImNsb25lTm9kZSIsImN1c3RvbUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxUb3AiLCJzY3JvbGxMZWZ0IiwiYWN0aXZlIiwiY3NzIiwicmVmIiwib3JpZ2luYWwiLCJ6b29tZWQiLCJpbnNlcnRBdCIsImhlYWQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInN0eWxlIiwiY3JlYXRlRWxlbWVudCIsImlzQW5pbWF0aW5nIiwiY2xhc3NMaXN0IiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsInRlbXBsYXRlIiwic3R5bGVTaGVldCIsImNzc1RleHQiLCJhcHBlbmRDaGlsZCIsImRpc3BhdGNoRXZlbnQiLCJzdHlsZUluamVjdCIsInBvc2l0aW9uIiwidW5kZWZpbmVkIiwiUHJvbWlzZSIsImZuIiwiYXR0YWNoIiwiX2xlbiIsInNlbGVjdG9ycyIsIkFycmF5IiwiX2tleSIsImV2ZW50Iiwid2hpY2giLCJpbWFnZXNBY2N1bXVsYXRvciIsImN1cnJlbnRTZWxlY3RvciIsImNsb3NlIiwiY29uY2F0IiwibmV3SW1hZ2VzIiwibmV3SW1hZ2UiLCJpbWFnZXMiLCJpbmRleE9mIiwidXBkYXRlIiwib3B0aW9ucyIsInB1c2giLCJuZXdPcHRpb25zIiwiZXZlbnRMaXN0ZW5lcnMiLCJiYWNrZ3JvdW5kIiwiX3JlZiIsIm92ZXJsYXkiLCJsaXN0ZW5lciIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiem9vbSIsIm9wZW4iLCJkZXRhY2giLCJfYW5pbWF0ZSIsImNsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0IiwicmlnaHQiLCJib3R0b20iLCJ2aWV3cG9ydFdpZHRoIiwidmlld3BvcnRIZWlnaHQiLCJpbWFnZXNUb0RldGFjaCIsInJlbW92ZSIsImRldGFpbCIsInpvb21PcHRpb25zIiwiY29udGFpbmVyIiwibWFyZ2luIiwiX3pvb21Db250YWluZXIkZ2V0Qm91IiwicXVlcnlTZWxlY3RvciIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIl93aWR0aCIsIl9oZWlnaHQiLCJfbGVmdCIsIl90b3AiLCJ6b29tVGFyZ2V0Iiwiem9vbWVkSGQiLCJuYXR1cmFsV2lkdGgiLCJuYXR1cmFsSGVpZ2h0IiwiX3pvb21UYXJnZXQkZ2V0Qm91bmRpIiwic2NhbGVZIiwiTWF0aCIsIm1pbiIsInNjYWxlWCIsInRyYW5zZm9ybSIsInNjYWxlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50TGlzdGVuZXIiLCJyZXNvbHZlIiwiYm9keSIsInNsaWNlIiwicGFnZVhPZmZzZXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjcmVhdGVPdmVybGF5IiwiY29udGVudCIsIl9oYW5kbGVPcGVuRW5kIiwiX3JlZjIiLCJzcmMiLCJnZXRBdHRyaWJ1dGUiLCJ0cmFuc2xhdGVYIiwidHJhbnNsYXRlWSIsImNvbXBsZXRlIiwiZ2V0Wm9vbVRhcmdldFNpemUiLCJhZGQiLCJoYXNBdHRyaWJ1dGUiLCJsb2FkRXZlbnRMaXN0ZW5lciIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIl9oYW5kbGVDbG9zZUVuZCIsInJlbW92ZUNoaWxkIiwiY2xlYXJJbnRlcnZhbCIsImNvbnNvbGUiLCJ3YXJuIiwidG9TdHJpbmciLCJjYW5jZWxhYmxlIiwidG9nZ2xlIiwia2V5Q29kZSIsImNyZWF0ZUV2ZW50IiwiY3VycmVudFNjcm9sbCIsImFicyIsInNjcm9sbE9mZnNldCIsIl9oYW5kbGVDbGljayIsIl9rZXkyIiwicmVkdWNlIiwib24iLCJvZmYiLCJzd2lwZXJMaXN0Iiwic3dpcGVyV2lkdGgiLCJfcmVmMyIsImdldENvbXB1dGVkU3R5bGUiLCJzd2lwZXIiLCJzd2lwZXJMaXN0V2lkdGgiLCJwYXJzZUludCIsIm9ubG9hZCIsImhlaWdodE9mU3dpcGVyIiwibWFyZ2luTGVmdCIsImdldEltYWdlcyIsInN3aXBlTW91c2VNb3ZlT24iLCJzd2lwZU1vdXNlTW92ZU9mZiIsImdldE9wdGlvbnMiLCJnZXRab29tZWRJbWFnZSIsInN1bW1Td2lwZURpc3RhbmNlIiwibGFzdEN1cnNvclBvc2l0aW9uIiwicGFnZVgiLCJ3YXlUb1doaWNoU3dpcGVJc01hZGUiLCJmaXJzdEN1cnNvclBvc2l0aW9uIiwic3dpcGVMaXN0TWFyZ2luTGVmdCIsImFkZGl0aW9uYWxTd2lwZURpc3RhbmNlIiwidHJhbnNpdGlvbiIsImNyZWF0ZVRleHROb2RlIiwic2V0VGltZW91dCIsIm5ld0N1cnNvclBvc2l0aW9uIiwiaW5pdGlhbEN1cnNvclBvc2l0aW9uIiwic3dpcGVEaXN0YW5jZSIsIm1vZGFsVHJpZ2dlcnMiLCJvcGVuTW9kYWxXaW5kb3ciLCJldnQiLCJtb2RhbElEIiwiZGF0YXNldCIsIm1vZGFsVGFyZ2V0IiwidGFyZ2V0TW9kYWwiLCJnZXRFbGVtZW50QnlJZCIsIm9wZW5lZE1vZGFsSUQiLCJjbG9zZU1vZGFsV2luZG93Iiwic2VydmljZVRpdGxlIiwiY3VycmVudFRhcmdldCIsInRleHRDb250ZW50IiwicmVwbGFjZSIsInRyaW0iLCJtb2RhbFRpdGxlIiwicGF0aFRvSW1hZ2UiLCJjcmVhdGVTZXJ2aWNlRXhhbXBsZU1vZGFsIiwiY2xvc2VNb2RhbEJ5QmFja2dyb3VuZCIsImNsb3NlTW9kYWxCeUVzYyIsImZvY3VzYWJsZUVsZW1lbnRzIiwiZmlyc3RGb2N1c2FibGVFbGVtZW50IiwibGFzdEZvY3VzYWJsZUVsZW1lbnQiLCJzaGlmdEtleSIsInByZXZlbnREZWZhdWx0IiwiYWN0aXZlRWxlbWVudCIsImZvY3VzIiwiaXNGYXN0U3dpcGUiLCJidXR0b24iLCJjbG9zZU1vZGFsQnlCdXR0b24iLCJtb2RhbHMiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInZhbHVlIiwicmV0dXJuIiwic2Nyb2xsaW5nTGlua3MiLCJzY3JvbGxUb0VsZW1lbnQiLCJzY3JvbGxUbyIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJCb29sZWFuIiwibGluayIsImluaXRpYWxpemVNb2RhbFRyaWdnZXJzIiwiY2xvc2VNb2RhbEJ1dHRvbnMiLCJlbnRyeSIsImxhenlJbWFnZSIsImxhenlQaWN0dXJlIiwibGF6eVdlYnBJbWFnZSIsInBhcmVudEVsZW1lbnQiLCJtb2RhbFNlcnZpY2VFeGFtcGxlSW1hZ2UiLCJtYWluQmxvY2tzIiwic2Nyb2xsTGluayIsIm9ic2VydmVyIiwiZW50cmllcyIsImlzSW50ZXJzZWN0aW5nIiwibWFpbkJsb2NrIiwic2V0QXR0cmlidXRlIiwibWFpbkJsb2NrT2JzZXJ2ZXIiLCJ1bm9ic2VydmUiLCJvYnNlcnZlIl0sIm1hcHBpbmdzIjoiQUFBQSwrUEFHQSxTQUFVQSxFQUFRQyxHQUNLLFlBQW5CLG9C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c291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKiEgbWVkaXVtLXpvb20gMS4wLjQgfCBNSVQgTGljZW5zZSB8IGh0dHBzOi8vZ2l0aHViLmNvbS9mcmFuY29pc2NoYWxpZm91ci9tZWRpdW0tem9vbSAqL1xuKGZ1bmN0aW9uKGdsb2JhbCwgZmFjdG9yeSkge1xuICAgIHR5cGVvZiBleHBvcnRzID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6IHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDogd2luZG93Lm1lZGl1bVpvb20gPSBmYWN0b3J5KCk7XG4gIH0pKHRoaXMsIGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odGFyZ2V0KSB7XG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH07XG4gICAgdmFyIGlzU3VwcG9ydGVkID0gZnVuY3Rpb24gaXNTdXBwb3J0ZWQobm9kZSkge1xuICAgICAgcmV0dXJuIG5vZGUudGFnTmFtZSA9PT0gXCJJTUdcIjtcbiAgICB9O1xuICAgIHZhciBpc05vZGVMaXN0ID0gZnVuY3Rpb24gaXNOb2RlTGlzdChzZWxlY3Rvcikge1xuICAgICAgcmV0dXJuIE5vZGVMaXN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHNlbGVjdG9yKTtcbiAgICB9O1xuICAgIHZhciBpc05vZGUgPSBmdW5jdGlvbiBpc05vZGUoc2VsZWN0b3IpIHtcbiAgICAgIHJldHVybiBzZWxlY3RvciAmJiBzZWxlY3Rvci5ub2RlVHlwZSA9PT0gMTtcbiAgICB9O1xuICAgIHZhciBpc1N2ZyA9IGZ1bmN0aW9uIGlzU3ZnKGltYWdlKSB7XG4gICAgICB2YXIgc291cmNlID0gaW1hZ2UuY3VycmVudFNyYyB8fCBpbWFnZS5zcmM7XG4gICAgICByZXR1cm4gc291cmNlLnN1YnN0cigtNCkudG9Mb3dlckNhc2UoKSA9PT0gXCIuc3ZnXCI7XG4gICAgfTtcbiAgICB2YXIgZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yID0gZnVuY3Rpb24gZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yKHNlbGVjdG9yKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzZWxlY3RvcikpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZWN0b3IuZmlsdGVyKGlzU3VwcG9ydGVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOb2RlTGlzdChzZWxlY3RvcikpIHtcbiAgICAgICAgICByZXR1cm4gW10uc2xpY2UuY2FsbChzZWxlY3RvcikuZmlsdGVyKGlzU3VwcG9ydGVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOb2RlKHNlbGVjdG9yKSkge1xuICAgICAgICAgIHJldHVybiBbIHNlbGVjdG9yIF0uZmlsdGVyKGlzU3VwcG9ydGVkKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgcmV0dXJuIFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmZpbHRlcihpc1N1cHBvcnRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJUaGUgcHJvdmlkZWQgc2VsZWN0b3IgaXMgaW52YWxpZC5cXG5cIiArIFwiRXhwZWN0cyBhIENTUyBzZWxlY3RvciwgYSBOb2RlIGVsZW1lbnQsIGEgTm9kZUxpc3Qgb3IgYW4gYXJyYXkuXFxuXCIgKyBcIlNlZTogaHR0cHM6Ly9naXRodWIuY29tL2ZyYW5jb2lzY2hhbGlmb3VyL21lZGl1bS16b29tXCIpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGNyZWF0ZU92ZXJsYXkgPSBmdW5jdGlvbiBjcmVhdGVPdmVybGF5KGJhY2tncm91bmQpIHtcbiAgICAgIHZhciBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LmFkZChcIm1lZGl1bS16b29tLW92ZXJsYXlcIik7XG4gICAgICBvdmVybGF5LnN0eWxlLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kO1xuICAgICAgcmV0dXJuIG92ZXJsYXk7XG4gICAgfTtcbiAgICB2YXIgY2xvbmVUYXJnZXQgPSBmdW5jdGlvbiBjbG9uZVRhcmdldCh0ZW1wbGF0ZSkge1xuICAgICAgdmFyIF90ZW1wbGF0ZSRnZXRCb3VuZGluZyA9IHRlbXBsYXRlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCB0b3AgPSBfdGVtcGxhdGUkZ2V0Qm91bmRpbmcudG9wLCBsZWZ0ID0gX3RlbXBsYXRlJGdldEJvdW5kaW5nLmxlZnQsIHdpZHRoID0gX3RlbXBsYXRlJGdldEJvdW5kaW5nLndpZHRoLCBoZWlnaHQgPSBfdGVtcGxhdGUkZ2V0Qm91bmRpbmcuaGVpZ2h0O1xuICAgICAgdmFyIGNsb25lID0gdGVtcGxhdGUuY2xvbmVOb2RlKCk7XG4gICAgICB2YXIgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgfHwgMDtcbiAgICAgIHZhciBzY3JvbGxMZWZ0ID0gd2luZG93LnBhZ2VYT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0IHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCB8fCAwO1xuICAgICAgY2xvbmUucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XG4gICAgICBjbG9uZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICAgIGNsb25lLnN0eWxlLnRvcCA9IHRvcCArIHNjcm9sbFRvcCArIFwicHhcIjtcbiAgICAgIGNsb25lLnN0eWxlLmxlZnQgPSBsZWZ0ICsgc2Nyb2xsTGVmdCArIFwicHhcIjtcbiAgICAgIGNsb25lLnN0eWxlLndpZHRoID0gd2lkdGggKyBcInB4XCI7XG4gICAgICBjbG9uZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XG4gICAgICBjbG9uZS5zdHlsZS50cmFuc2Zvcm0gPSBcIlwiO1xuICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgdmFyIGNyZWF0ZUN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRXZlbnQodHlwZSwgcGFyYW1zKSB7XG4gICAgICB2YXIgZXZlbnRQYXJhbXMgPSBfZXh0ZW5kcyh7XG4gICAgICAgIGJ1YmJsZXM6IGZhbHNlLFxuICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZSxcbiAgICAgICAgZGV0YWlsOiB1bmRlZmluZWRcbiAgICAgIH0sIHBhcmFtcyk7XG4gICAgICBpZiAodHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ3VzdG9tRXZlbnQodHlwZSwgZXZlbnRQYXJhbXMpO1xuICAgICAgfVxuICAgICAgdmFyIGN1c3RvbUV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKTtcbiAgICAgIGN1c3RvbUV2ZW50LmluaXRDdXN0b21FdmVudCh0eXBlLCBldmVudFBhcmFtcy5idWJibGVzLCBldmVudFBhcmFtcy5jYW5jZWxhYmxlLCBldmVudFBhcmFtcy5kZXRhaWwpO1xuICAgICAgcmV0dXJuIGN1c3RvbUV2ZW50O1xuICAgIH07XG4gICAgdmFyIG1lZGl1bVpvb20gPSBmdW5jdGlvbiBtZWRpdW1ab29tKHNlbGVjdG9yKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gICAgICB2YXIgUHJvbWlzZSA9IHdpbmRvdy5Qcm9taXNlIHx8IGZ1bmN0aW9uIFByb21pc2UoZm4pIHtcbiAgICAgICAgZnVuY3Rpb24gbm9vcCgpIHt9XG4gICAgICAgIGZuKG5vb3AsIG5vb3ApO1xuICAgICAgfTtcbiAgICAgIHZhciBfaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiBfaGFuZGxlQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKHRhcmdldCA9PT0gb3ZlcmxheSkge1xuICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbWFnZXMuaW5kZXhPZih0YXJnZXQpID09PSAtMSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0b2dnbGUoe1xuICAgICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHZhciBfaGFuZGxlU2Nyb2xsID0gZnVuY3Rpb24gX2hhbmRsZVNjcm9sbCgpIHtcbiAgICAgICAgaWYgKGlzQW5pbWF0aW5nIHx8ICFhY3RpdmUub3JpZ2luYWwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnJlbnRTY3JvbGwgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCB8fCAwO1xuICAgICAgICBpZiAoTWF0aC5hYnMoc2Nyb2xsVG9wIC0gY3VycmVudFNjcm9sbCkgPiB6b29tT3B0aW9ucy5zY3JvbGxPZmZzZXQpIHtcbiAgICAgICAgICBzZXRUaW1lb3V0KGNsb3NlLCAxNTApO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgdmFyIF9oYW5kbGVLZXlVcCA9IGZ1bmN0aW9uIF9oYW5kbGVLZXlVcChldmVudCkge1xuICAgICAgICBpZiAoKGV2ZW50LmtleUNvZGUgfHwgZXZlbnQud2hpY2gpID09PSAyNykge1xuICAgICAgICAgIGNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgICAgIHZhciBuZXdPcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgaWYgKG9wdGlvbnMuYmFja2dyb3VuZCkge1xuICAgICAgICAgIG92ZXJsYXkuc3R5bGUuYmFja2dyb3VuZCA9IG9wdGlvbnMuYmFja2dyb3VuZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5jb250YWluZXIgJiYgb3B0aW9ucy5jb250YWluZXIgaW5zdGFuY2VvZiBPYmplY3QpIHtcbiAgICAgICAgICBuZXdPcHRpb25zLmNvbnRhaW5lciA9IF9leHRlbmRzKHt9LCB6b29tT3B0aW9ucy5jb250YWluZXIsIG9wdGlvbnMuY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IGlzTm9kZShvcHRpb25zLnRlbXBsYXRlKSA/IG9wdGlvbnMudGVtcGxhdGUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdGlvbnMudGVtcGxhdGUpO1xuICAgICAgICAgIG5ld09wdGlvbnMudGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICAgICAgfVxuICAgICAgICB6b29tT3B0aW9ucyA9IF9leHRlbmRzKHt9LCB6b29tT3B0aW9ucywgbmV3T3B0aW9ucyk7XG4gICAgICAgIGltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKGltYWdlKSB7XG4gICAgICAgICAgaW1hZ2UuZGlzcGF0Y2hFdmVudChjcmVhdGVDdXN0b21FdmVudChcIm1lZGl1bS16b29tOnVwZGF0ZVwiLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgem9vbTogem9vbVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB6b29tO1xuICAgICAgfTtcbiAgICAgIHZhciBjbG9uZSA9IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgICAgIHJldHVybiBtZWRpdW1ab29tKF9leHRlbmRzKHt9LCB6b29tT3B0aW9ucywgb3B0aW9ucykpO1xuICAgICAgfTtcbiAgICAgIHZhciBhdHRhY2ggPSBmdW5jdGlvbiBhdHRhY2goKSB7XG4gICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBzZWxlY3RvcnMgPSBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgICBzZWxlY3RvcnNbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld0ltYWdlcyA9IHNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24oaW1hZ2VzQWNjdW11bGF0b3IsIGN1cnJlbnRTZWxlY3Rvcikge1xuICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoaW1hZ2VzQWNjdW11bGF0b3IsIGdldEltYWdlc0Zyb21TZWxlY3RvcihjdXJyZW50U2VsZWN0b3IpKTtcbiAgICAgICAgfSwgW10pO1xuICAgICAgICBuZXdJbWFnZXMuZmlsdGVyKGZ1bmN0aW9uKG5ld0ltYWdlKSB7XG4gICAgICAgICAgcmV0dXJuIGltYWdlcy5pbmRleE9mKG5ld0ltYWdlKSA9PT0gLTE7XG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24obmV3SW1hZ2UpIHtcbiAgICAgICAgICBpbWFnZXMucHVzaChuZXdJbWFnZSk7XG4gICAgICAgICAgbmV3SW1hZ2UuY2xhc3NMaXN0LmFkZChcIm1lZGl1bS16b29tLWltYWdlXCIpO1xuICAgICAgICB9KTtcbiAgICAgICAgZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbihfcmVmKSB7XG4gICAgICAgICAgdmFyIHR5cGUgPSBfcmVmLnR5cGUsIGxpc3RlbmVyID0gX3JlZi5saXN0ZW5lciwgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgICAgICAgICBuZXdJbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICAgICAgaW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gem9vbTtcbiAgICAgIH07XG4gICAgICB2YXIgZGV0YWNoID0gZnVuY3Rpb24gZGV0YWNoKCkge1xuICAgICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIHNlbGVjdG9ycyA9IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgICAgc2VsZWN0b3JzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGl2ZS56b29tZWQpIHtcbiAgICAgICAgICBjbG9zZSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbWFnZXNUb0RldGFjaCA9IHNlbGVjdG9ycy5sZW5ndGggPiAwID8gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbihpbWFnZXNBY2N1bXVsYXRvciwgY3VycmVudFNlbGVjdG9yKSB7XG4gICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChpbWFnZXNBY2N1bXVsYXRvciwgZ2V0SW1hZ2VzRnJvbVNlbGVjdG9yKGN1cnJlbnRTZWxlY3RvcikpO1xuICAgICAgICB9LCBbXSkgOiBpbWFnZXM7XG4gICAgICAgIGltYWdlc1RvRGV0YWNoLmZvckVhY2goZnVuY3Rpb24oaW1hZ2UpIHtcbiAgICAgICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKFwibWVkaXVtLXpvb20taW1hZ2VcIik7XG4gICAgICAgICAgaW1hZ2UuZGlzcGF0Y2hFdmVudChjcmVhdGVDdXN0b21FdmVudChcIm1lZGl1bS16b29tOmRldGFjaFwiLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgem9vbTogem9vbVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGltYWdlcyA9IGltYWdlcy5maWx0ZXIoZnVuY3Rpb24oaW1hZ2UpIHtcbiAgICAgICAgICByZXR1cm4gaW1hZ2VzVG9EZXRhY2guaW5kZXhPZihpbWFnZSkgPT09IC0xO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHpvb207XG4gICAgICB9O1xuICAgICAgdmFyIG9uID0gZnVuY3Rpb24gb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICAgICAgICBpbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xuICAgICAgICAgIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJtZWRpdW0tem9vbTpcIiArIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50TGlzdGVuZXJzLnB1c2goe1xuICAgICAgICAgIHR5cGU6IFwibWVkaXVtLXpvb206XCIgKyB0eXBlLFxuICAgICAgICAgIGxpc3RlbmVyOiBsaXN0ZW5lcixcbiAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gem9vbTtcbiAgICAgIH07XG4gICAgICB2YXIgb2ZmID0gZnVuY3Rpb24gb2ZmKHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgICAgICAgaW1hZ2VzLmZvckVhY2goZnVuY3Rpb24oaW1hZ2UpIHtcbiAgICAgICAgICBpbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVkaXVtLXpvb206XCIgKyB0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgICAgICBldmVudExpc3RlbmVycyA9IGV2ZW50TGlzdGVuZXJzLmZpbHRlcihmdW5jdGlvbihldmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgcmV0dXJuICEoZXZlbnRMaXN0ZW5lci50eXBlID09PSBcIm1lZGl1bS16b29tOlwiICsgdHlwZSAmJiBldmVudExpc3RlbmVyLmxpc3RlbmVyLnRvU3RyaW5nKCkgPT09IGxpc3RlbmVyLnRvU3RyaW5nKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHpvb207XG4gICAgICB9O1xuICAgICAgdmFyIG9wZW4gPSBmdW5jdGlvbiBvcGVuKCkge1xuICAgICAgICB2YXIgX3JlZjIgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9LCB0YXJnZXQgPSBfcmVmMi50YXJnZXQ7XG4gICAgICAgIHZhciBfYW5pbWF0ZSA9IGZ1bmN0aW9uIF9hbmltYXRlKCkge1xuICAgICAgICAgIHZhciBjb250YWluZXIgPSB7XG4gICAgICAgICAgICB3aWR0aDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0LFxuICAgICAgICAgICAgbGVmdDogMCxcbiAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgICAgYm90dG9tOiAwXG4gICAgICAgICAgfTtcbiAgICAgICAgICB2YXIgdmlld3BvcnRXaWR0aCA9IHZvaWQgMDtcbiAgICAgICAgICB2YXIgdmlld3BvcnRIZWlnaHQgPSB2b2lkIDA7XG4gICAgICAgICAgaWYgKHpvb21PcHRpb25zLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgaWYgKHpvb21PcHRpb25zLmNvbnRhaW5lciBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgICAgICAgICAgICBjb250YWluZXIgPSBfZXh0ZW5kcyh7fSwgY29udGFpbmVyLCB6b29tT3B0aW9ucy5jb250YWluZXIpO1xuICAgICAgICAgICAgICB2aWV3cG9ydFdpZHRoID0gY29udGFpbmVyLndpZHRoIC0gY29udGFpbmVyLmxlZnQgLSBjb250YWluZXIucmlnaHQgLSB6b29tT3B0aW9ucy5tYXJnaW4gKiAyO1xuICAgICAgICAgICAgICB2aWV3cG9ydEhlaWdodCA9IGNvbnRhaW5lci5oZWlnaHQgLSBjb250YWluZXIudG9wIC0gY29udGFpbmVyLmJvdHRvbSAtIHpvb21PcHRpb25zLm1hcmdpbiAqIDI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YXIgem9vbUNvbnRhaW5lciA9IGlzTm9kZSh6b29tT3B0aW9ucy5jb250YWluZXIpID8gem9vbU9wdGlvbnMuY29udGFpbmVyIDogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih6b29tT3B0aW9ucy5jb250YWluZXIpO1xuICAgICAgICAgICAgICB2YXIgX3pvb21Db250YWluZXIkZ2V0Qm91ID0gem9vbUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgX3dpZHRoID0gX3pvb21Db250YWluZXIkZ2V0Qm91LndpZHRoLCBfaGVpZ2h0ID0gX3pvb21Db250YWluZXIkZ2V0Qm91LmhlaWdodCwgX2xlZnQgPSBfem9vbUNvbnRhaW5lciRnZXRCb3UubGVmdCwgX3RvcCA9IF96b29tQ29udGFpbmVyJGdldEJvdS50b3A7XG4gICAgICAgICAgICAgIGNvbnRhaW5lciA9IF9leHRlbmRzKHt9LCBjb250YWluZXIsIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogX3dpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodDogX2hlaWdodCxcbiAgICAgICAgICAgICAgICBsZWZ0OiBfbGVmdCxcbiAgICAgICAgICAgICAgICB0b3A6IF90b3BcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZpZXdwb3J0V2lkdGggPSB2aWV3cG9ydFdpZHRoIHx8IGNvbnRhaW5lci53aWR0aCAtIHpvb21PcHRpb25zLm1hcmdpbiAqIDI7XG4gICAgICAgICAgdmlld3BvcnRIZWlnaHQgPSB2aWV3cG9ydEhlaWdodCB8fCBjb250YWluZXIuaGVpZ2h0IC0gem9vbU9wdGlvbnMubWFyZ2luICogMjtcbiAgICAgICAgICB2YXIgem9vbVRhcmdldCA9IGFjdGl2ZS56b29tZWRIZCB8fCBhY3RpdmUub3JpZ2luYWw7XG4gICAgICAgICAgdmFyIG5hdHVyYWxXaWR0aCA9IGlzU3ZnKHpvb21UYXJnZXQpID8gdmlld3BvcnRXaWR0aCA6IHpvb21UYXJnZXQubmF0dXJhbFdpZHRoIHx8IHZpZXdwb3J0V2lkdGg7XG4gICAgICAgICAgdmFyIG5hdHVyYWxIZWlnaHQgPSBpc1N2Zyh6b29tVGFyZ2V0KSA/IHZpZXdwb3J0SGVpZ2h0IDogem9vbVRhcmdldC5uYXR1cmFsSGVpZ2h0IHx8IHZpZXdwb3J0SGVpZ2h0O1xuICAgICAgICAgIHZhciBfem9vbVRhcmdldCRnZXRCb3VuZGkgPSB6b29tVGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCB0b3AgPSBfem9vbVRhcmdldCRnZXRCb3VuZGkudG9wLCBsZWZ0ID0gX3pvb21UYXJnZXQkZ2V0Qm91bmRpLmxlZnQsIHdpZHRoID0gX3pvb21UYXJnZXQkZ2V0Qm91bmRpLndpZHRoLCBoZWlnaHQgPSBfem9vbVRhcmdldCRnZXRCb3VuZGkuaGVpZ2h0O1xuICAgICAgICAgIHZhciBzY2FsZVggPSBNYXRoLm1pbihuYXR1cmFsV2lkdGgsIHZpZXdwb3J0V2lkdGgpIC8gd2lkdGg7XG4gICAgICAgICAgdmFyIHNjYWxlWSA9IE1hdGgubWluKG5hdHVyYWxIZWlnaHQsIHZpZXdwb3J0SGVpZ2h0KSAvIGhlaWdodDtcbiAgICAgICAgICB2YXIgc2NhbGUgPSBNYXRoLm1pbihzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgICAgdmFyIHRyYW5zbGF0ZVggPSAoLWxlZnQgKyAodmlld3BvcnRXaWR0aCAtIHdpZHRoKSAvIDIgKyB6b29tT3B0aW9ucy5tYXJnaW4gKyBjb250YWluZXIubGVmdCkgLyBzY2FsZTtcbiAgICAgICAgICB2YXIgdHJhbnNsYXRlWSA9ICgtdG9wICsgKHZpZXdwb3J0SGVpZ2h0IC0gaGVpZ2h0KSAvIDIgKyB6b29tT3B0aW9ucy5tYXJnaW4gKyBjb250YWluZXIudG9wKSAvIHNjYWxlO1xuICAgICAgICAgIHZhciB0cmFuc2Zvcm0gPSBcInNjYWxlKFwiICsgc2NhbGUgKyBcIikgdHJhbnNsYXRlM2QoXCIgKyB0cmFuc2xhdGVYICsgXCJweCwgXCIgKyB0cmFuc2xhdGVZICsgXCJweCwgMClcIjtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTtcbiAgICAgICAgICBpZiAoYWN0aXZlLnpvb21lZEhkKSB7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQuc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgICBpZiAodGFyZ2V0ICYmIGltYWdlcy5pbmRleE9mKHRhcmdldCkgPT09IC0xKSB7XG4gICAgICAgICAgICByZXNvbHZlKHpvb20pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgX2hhbmRsZU9wZW5FbmQgPSBmdW5jdGlvbiBfaGFuZGxlT3BlbkVuZCgpIHtcbiAgICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIF9oYW5kbGVPcGVuRW5kKTtcbiAgICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206b3BlbmVkXCIsIHtcbiAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgem9vbTogem9vbVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXNvbHZlKHpvb20pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGFjdGl2ZS56b29tZWQpIHtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbCA9IHRhcmdldDtcbiAgICAgICAgICB9IGVsc2UgaWYgKGltYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgX2ltYWdlcyA9IGltYWdlcztcbiAgICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbCA9IF9pbWFnZXNbMF07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUoem9vbSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGl2ZS5vcmlnaW5hbC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUN1c3RvbUV2ZW50KFwibWVkaXVtLXpvb206b3BlblwiLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHtcbiAgICAgICAgICAgICAgem9vbTogem9vbVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCB8fCAwO1xuICAgICAgICAgIGlzQW5pbWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkID0gY2xvbmVUYXJnZXQoYWN0aXZlLm9yaWdpbmFsKTtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuICAgICAgICAgIGlmICh6b29tT3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gaXNOb2RlKHpvb21PcHRpb25zLnRlbXBsYXRlKSA/IHpvb21PcHRpb25zLnRlbXBsYXRlIDogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih6b29tT3B0aW9ucy50ZW1wbGF0ZSk7XG4gICAgICAgICAgICBhY3RpdmUudGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgYWN0aXZlLnRlbXBsYXRlLmFwcGVuZENoaWxkKHRlbXBsYXRlLmNvbnRlbnQuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYWN0aXZlLnRlbXBsYXRlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhY3RpdmUuem9vbWVkKTtcbiAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20tLW9wZW5lZFwiKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBhY3RpdmUub3JpZ2luYWwuY2xhc3NMaXN0LmFkZChcIm1lZGl1bS16b29tLWltYWdlLS1oaWRkZW5cIik7XG4gICAgICAgICAgYWN0aXZlLnpvb21lZC5jbGFzc0xpc3QuYWRkKFwibWVkaXVtLXpvb20taW1hZ2UtLW9wZW5lZFwiKTtcbiAgICAgICAgICBhY3RpdmUuem9vbWVkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZSk7XG4gICAgICAgICAgYWN0aXZlLnpvb21lZC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBfaGFuZGxlT3BlbkVuZCk7XG4gICAgICAgICAgaWYgKGFjdGl2ZS5vcmlnaW5hbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXpvb20tc3JjXCIpKSB7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQgPSBhY3RpdmUuem9vbWVkLmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLnJlbW92ZUF0dHJpYnV0ZShcInNyY3NldFwiKTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5yZW1vdmVBdHRyaWJ1dGUoXCJzaXplc1wiKTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5zcmMgPSBhY3RpdmUuem9vbWVkLmdldEF0dHJpYnV0ZShcImRhdGEtem9vbS1zcmNcIik7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBjbGVhckludGVydmFsKGdldFpvb21UYXJnZXRTaXplKTtcbiAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiVW5hYmxlIHRvIHJlYWNoIHRoZSB6b29tIGltYWdlIHRhcmdldCBcIiArIGFjdGl2ZS56b29tZWRIZC5zcmMpO1xuICAgICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQgPSBudWxsO1xuICAgICAgICAgICAgICBfYW5pbWF0ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBnZXRab29tVGFyZ2V0U2l6ZSA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBpZiAoYWN0aXZlLnpvb21lZEhkLmNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChnZXRab29tVGFyZ2V0U2l6ZSk7XG4gICAgICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLmNsYXNzTGlzdC5hZGQoXCJtZWRpdW0tem9vbS1pbWFnZS0tb3BlbmVkXCIpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2UpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYWN0aXZlLnpvb21lZEhkKTtcbiAgICAgICAgICAgICAgICBfYW5pbWF0ZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChhY3RpdmUub3JpZ2luYWwuaGFzQXR0cmlidXRlKFwic3Jjc2V0XCIpKSB7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQgPSBhY3RpdmUuem9vbWVkLmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkLnJlbW92ZUF0dHJpYnV0ZShcInNpemVzXCIpO1xuICAgICAgICAgICAgdmFyIGxvYWRFdmVudExpc3RlbmVyID0gYWN0aXZlLnpvb21lZEhkLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgbG9hZEV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgICBhY3RpdmUuem9vbWVkSGQuY2xhc3NMaXN0LmFkZChcIm1lZGl1bS16b29tLWltYWdlLS1vcGVuZWRcIik7XG4gICAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2UpO1xuICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFjdGl2ZS56b29tZWRIZCk7XG4gICAgICAgICAgICAgIF9hbmltYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgX2FuaW1hdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHZhciBjbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICAgIGlmIChpc0FuaW1hdGluZyB8fCAhYWN0aXZlLm9yaWdpbmFsKSB7XG4gICAgICAgICAgICByZXNvbHZlKHpvb20pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgX2hhbmRsZUNsb3NlRW5kID0gZnVuY3Rpb24gX2hhbmRsZUNsb3NlRW5kKCkge1xuICAgICAgICAgICAgYWN0aXZlLm9yaWdpbmFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtZWRpdW0tem9vbS1pbWFnZS0taGlkZGVuXCIpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhY3RpdmUuem9vbWVkKTtcbiAgICAgICAgICAgIGlmIChhY3RpdmUuem9vbWVkSGQpIHtcbiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhY3RpdmUuem9vbWVkSGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWQuY2xhc3NMaXN0LnJlbW92ZShcIm1lZGl1bS16b29tLWltYWdlLS1vcGVuZWRcIik7XG4gICAgICAgICAgICBpZiAoYWN0aXZlLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYWN0aXZlLnRlbXBsYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBhY3RpdmUuem9vbWVkLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIF9oYW5kbGVDbG9zZUVuZCk7XG4gICAgICAgICAgICBhY3RpdmUub3JpZ2luYWwuZGlzcGF0Y2hFdmVudChjcmVhdGVDdXN0b21FdmVudChcIm1lZGl1bS16b29tOmNsb3NlZFwiLCB7XG4gICAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICAgIHpvb206IHpvb21cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgYWN0aXZlLm9yaWdpbmFsID0gbnVsbDtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWQgPSBudWxsO1xuICAgICAgICAgICAgYWN0aXZlLnpvb21lZEhkID0gbnVsbDtcbiAgICAgICAgICAgIGFjdGl2ZS50ZW1wbGF0ZSA9IG51bGw7XG4gICAgICAgICAgICByZXNvbHZlKHpvb20pO1xuICAgICAgICAgIH07XG4gICAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuICAgICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcIm1lZGl1bS16b29tLS1vcGVuZWRcIik7XG4gICAgICAgICAgYWN0aXZlLnpvb21lZC5zdHlsZS50cmFuc2Zvcm0gPSBcIlwiO1xuICAgICAgICAgIGlmIChhY3RpdmUuem9vbWVkSGQpIHtcbiAgICAgICAgICAgIGFjdGl2ZS56b29tZWRIZC5zdHlsZS50cmFuc2Zvcm0gPSBcIlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoYWN0aXZlLnRlbXBsYXRlKSB7XG4gICAgICAgICAgICBhY3RpdmUudGVtcGxhdGUuc3R5bGUudHJhbnNpdGlvbiA9IFwib3BhY2l0eSAxNTBtc1wiO1xuICAgICAgICAgICAgYWN0aXZlLnRlbXBsYXRlLnN0eWxlLm9wYWNpdHkgPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhY3RpdmUub3JpZ2luYWwuZGlzcGF0Y2hFdmVudChjcmVhdGVDdXN0b21FdmVudChcIm1lZGl1bS16b29tOmNsb3NlXCIsIHtcbiAgICAgICAgICAgIGRldGFpbDoge1xuICAgICAgICAgICAgICB6b29tOiB6b29tXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGFjdGl2ZS56b29tZWQuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgX2hhbmRsZUNsb3NlRW5kKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuICAgICAgdmFyIHRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHtcbiAgICAgICAgdmFyIF9yZWYzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fSwgdGFyZ2V0ID0gX3JlZjMudGFyZ2V0O1xuICAgICAgICBpZiAoYWN0aXZlLm9yaWdpbmFsKSB7XG4gICAgICAgICAgcmV0dXJuIGNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9wZW4oe1xuICAgICAgICAgIHRhcmdldDogdGFyZ2V0XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICAgIHZhciBnZXRPcHRpb25zID0gZnVuY3Rpb24gZ2V0T3B0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHpvb21PcHRpb25zO1xuICAgICAgfTtcbiAgICAgIHZhciBnZXRJbWFnZXMgPSBmdW5jdGlvbiBnZXRJbWFnZXMoKSB7XG4gICAgICAgIHJldHVybiBpbWFnZXM7XG4gICAgICB9O1xuICAgICAgdmFyIGdldFpvb21lZEltYWdlID0gZnVuY3Rpb24gZ2V0Wm9vbWVkSW1hZ2UoKSB7XG4gICAgICAgIHJldHVybiBhY3RpdmUub3JpZ2luYWw7XG4gICAgICB9O1xuICAgICAgdmFyIGltYWdlcyA9IFtdO1xuICAgICAgdmFyIGV2ZW50TGlzdGVuZXJzID0gW107XG4gICAgICB2YXIgaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgIHZhciBzY3JvbGxUb3AgPSAwO1xuICAgICAgdmFyIHpvb21PcHRpb25zID0gb3B0aW9ucztcbiAgICAgIHZhciBhY3RpdmUgPSB7XG4gICAgICAgIG9yaWdpbmFsOiBudWxsLFxuICAgICAgICB6b29tZWQ6IG51bGwsXG4gICAgICAgIHpvb21lZEhkOiBudWxsLFxuICAgICAgICB0ZW1wbGF0ZTogbnVsbFxuICAgICAgfTtcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoc2VsZWN0b3IpID09PSBcIltvYmplY3QgT2JqZWN0XVwiKSB7XG4gICAgICAgIHpvb21PcHRpb25zID0gc2VsZWN0b3I7XG4gICAgICB9IGVsc2UgaWYgKHNlbGVjdG9yIHx8IHR5cGVvZiBzZWxlY3RvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBhdHRhY2goc2VsZWN0b3IpO1xuICAgICAgfVxuICAgICAgem9vbU9wdGlvbnMgPSBfZXh0ZW5kcyh7XG4gICAgICAgIG1hcmdpbjogMCxcbiAgICAgICAgYmFja2dyb3VuZDogXCIjZmZmXCIsXG4gICAgICAgIHNjcm9sbE9mZnNldDogNDAsXG4gICAgICAgIGNvbnRhaW5lcjogbnVsbCxcbiAgICAgICAgdGVtcGxhdGU6IG51bGxcbiAgICAgIH0sIHpvb21PcHRpb25zKTtcbiAgICAgIHZhciBvdmVybGF5ID0gY3JlYXRlT3ZlcmxheSh6b29tT3B0aW9ucy5iYWNrZ3JvdW5kKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBfaGFuZGxlQ2xpY2spO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIF9oYW5kbGVLZXlVcCk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIF9oYW5kbGVTY3JvbGwpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgY2xvc2UpO1xuICAgICAgdmFyIHpvb20gPSB7XG4gICAgICAgIG9wZW46IG9wZW4sXG4gICAgICAgIGNsb3NlOiBjbG9zZSxcbiAgICAgICAgdG9nZ2xlOiB0b2dnbGUsXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICBjbG9uZTogY2xvbmUsXG4gICAgICAgIGF0dGFjaDogYXR0YWNoLFxuICAgICAgICBkZXRhY2g6IGRldGFjaCxcbiAgICAgICAgb246IG9uLFxuICAgICAgICBvZmY6IG9mZixcbiAgICAgICAgZ2V0T3B0aW9uczogZ2V0T3B0aW9ucyxcbiAgICAgICAgZ2V0SW1hZ2VzOiBnZXRJbWFnZXMsXG4gICAgICAgIGdldFpvb21lZEltYWdlOiBnZXRab29tZWRJbWFnZVxuICAgICAgfTtcbiAgICAgIHJldHVybiB6b29tO1xuICAgIH07XG4gICAgZnVuY3Rpb24gc3R5bGVJbmplY3QoY3NzLCByZWYpIHtcbiAgICAgIGlmIChyZWYgPT09IHZvaWQgMCkgcmVmID0ge307XG4gICAgICB2YXIgaW5zZXJ0QXQgPSByZWYuaW5zZXJ0QXQ7XG4gICAgICBpZiAoIWNzcyB8fCB0eXBlb2YgZG9jdW1lbnQgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtcbiAgICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgICAgIHN0eWxlLnR5cGUgPSBcInRleHQvY3NzXCI7XG4gICAgICBpZiAoaW5zZXJ0QXQgPT09IFwidG9wXCIpIHtcbiAgICAgICAgaWYgKGhlYWQuZmlyc3RDaGlsZCkge1xuICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlLCBoZWFkLmZpcnN0Q2hpbGQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgIH1cbiAgICAgIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7XG4gICAgICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgY3NzID0gXCIubWVkaXVtLXpvb20tb3ZlcmxheXtwb3NpdGlvbjpmaXhlZDt0b3A6MDtyaWdodDowO2JvdHRvbTowO2xlZnQ6MDtvcGFjaXR5OjA7dHJhbnNpdGlvbjpvcGFjaXR5IC4zczt3aWxsLWNoYW5nZTpvcGFjaXR5fS5tZWRpdW0tem9vbS0tb3BlbmVkIC5tZWRpdW0tem9vbS1vdmVybGF5e2N1cnNvcjpwb2ludGVyO2N1cnNvcjp6b29tLW91dDtvcGFjaXR5OjF9Lm1lZGl1bS16b29tLWltYWdle2N1cnNvcjpwb2ludGVyO2N1cnNvcjp6b29tLWluO3RyYW5zaXRpb246dHJhbnNmb3JtIC4zcyBjdWJpYy1iZXppZXIoLjIsMCwuMiwxKX0ubWVkaXVtLXpvb20taW1hZ2UtLWhpZGRlbnt2aXNpYmlsaXR5OmhpZGRlbn0ubWVkaXVtLXpvb20taW1hZ2UtLW9wZW5lZHtwb3NpdGlvbjpyZWxhdGl2ZTtjdXJzb3I6cG9pbnRlcjtjdXJzb3I6em9vbS1vdXQ7d2lsbC1jaGFuZ2U6dHJhbnNmb3JtfVwiO1xuICAgIHN0eWxlSW5qZWN0KGNzcyk7XG4gICAgcmV0dXJuIG1lZGl1bVpvb207XG4gIH0pO1xuKCgpID0+IHtcbiAgICBsZXRcbiAgICAgICAgc3dpcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm90aGVyLXNlcnZpY2VzX19zd2lwZXInKSxcbiAgICAgICAgc3dpcGVyTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5vdGhlci1zZXJ2aWNlc19fbGlzdCcpLFxuICAgICAgICBzd2lwZXJXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoc3dpcGVyKS53aWR0aCksXG4gICAgICAgIHN3aXBlckxpc3RXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUoc3dpcGVyTGlzdCkud2lkdGgpO1xuXG5cbiAgICB3aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICAgICAgICBsZXQgaGVpZ2h0T2ZTd2lwZXIgPSBnZXRDb21wdXRlZFN0eWxlKHN3aXBlcikuaGVpZ2h0O1xuICAgICAgICBzd2lwZXIuc3R5bGUuaGVpZ2h0ID0gYCR7cGFyc2VJbnQoaGVpZ2h0T2ZTd2lwZXIpICsgNDB9cHhgO1xuICAgIH1cblxuXG4gICAgc3dpcGVyTGlzdC5zdHlsZS5tYXJnaW5MZWZ0ID0gJzBweCc7XG5cblxuICAgIGZ1bmN0aW9uIHN3aXBlKGV2ZW50KSB7XG5cbiAgICAgICAgc3dpcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBzd2l0Y2hPZmZTd2lwZXIpO1xuXG4gICAgICAgIGZ1bmN0aW9uIHN3aXRjaE9mZlN3aXBlcigpIHtcbiAgICAgICAgICAgIHN3aXBlci5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBzd2lwZU1vdXNlTW92ZU9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXBlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgc3dpcGVNb3VzZU1vdmVPZmYpO1xuXG4gICAgICAgIGxldFxuICAgICAgICAgICAgZmlyc3RDdXJzb3JQb3NpdGlvbiA9IGV2ZW50LnBhZ2VYLFxuICAgICAgICAgICAgaW5pdGlhbEN1cnNvclBvc2l0aW9uID0gZXZlbnQucGFnZVgsXG4gICAgICAgICAgICBzdW1tU3dpcGVEaXN0YW5jZSA9IDAsXG4gICAgICAgICAgICB3YXlUb1doaWNoU3dpcGVJc01hZGUsXG4gICAgICAgICAgICBzd2lwZUxpc3RNYXJnaW5MZWZ0LFxuICAgICAgICAgICAgaXNGYXN0U3dpcGUgPSBmYWxzZTtcblxuICAgICAgICBzd2lwZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc3dpcGVNb3VzZU1vdmVPbik7XG5cbiAgICAgICAgZnVuY3Rpb24gc3dpcGVNb3VzZU1vdmVPbihldmVudCkge1xuXG4gICAgICAgICAgICBsZXRcbiAgICAgICAgICAgICAgICBuZXdDdXJzb3JQb3NpdGlvbiA9IGV2ZW50LnBhZ2VYLFxuICAgICAgICAgICAgICAgIHN3aXBlRGlzdGFuY2UgPSBNYXRoLmFicyhpbml0aWFsQ3Vyc29yUG9zaXRpb24gLSBuZXdDdXJzb3JQb3NpdGlvbik7XG5cbiAgICAgICAgICAgIHN3aXBlTGlzdE1hcmdpbkxlZnQgPSBwYXJzZUludChzd2lwZXJMaXN0LnN0eWxlLm1hcmdpbkxlZnQpO1xuXG4gICAgICAgICAgICBpZiAobmV3Q3Vyc29yUG9zaXRpb24gPCBpbml0aWFsQ3Vyc29yUG9zaXRpb24pIHdheVRvV2hpY2hTd2lwZUlzTWFkZSA9ICdsZWZ0JztcbiAgICAgICAgICAgIGVsc2UgaWYgKG5ld0N1cnNvclBvc2l0aW9uID4gaW5pdGlhbEN1cnNvclBvc2l0aW9uKSB3YXlUb1doaWNoU3dpcGVJc01hZGUgPSAncmlnaHQnO1xuICAgICAgICAgICAgZWxzZSBpZiAobmV3Q3Vyc29yUG9zaXRpb24gPSBpbml0aWFsQ3Vyc29yUG9zaXRpb24pIHdheVRvV2hpY2hTd2lwZUlzTWFkZSA9IHdheVRvV2hpY2hTd2lwZUlzTWFkZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc3dpdGNoKHdheVRvV2hpY2hTd2lwZUlzTWFkZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxuXG4gICAgICAgICAgICAgICAgICAgIGlmICgtc3dpcGVMaXN0TWFyZ2luTGVmdCA+PSAoc3dpcGVyTGlzdFdpZHRoIC0gc3dpcGVyV2lkdGgpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIHN3aXBlckxpc3Quc3R5bGUubWFyZ2luTGVmdCA9IGAke3N3aXBlTGlzdE1hcmdpbkxlZnQgLSBzd2lwZURpc3RhbmNlfXB4YDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3dpcGVMaXN0TWFyZ2luTGVmdCA+PSAwICkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBzd2lwZXJMaXN0LnN0eWxlLm1hcmdpbkxlZnQgPSBgJHtzd2lwZUxpc3RNYXJnaW5MZWZ0ICsgc3dpcGVEaXN0YW5jZX1weGA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN1bW1Td2lwZURpc3RhbmNlICs9IHN3aXBlRGlzdGFuY2U7XG4gICAgICAgICAgICBpbml0aWFsQ3Vyc29yUG9zaXRpb24gPSBuZXdDdXJzb3JQb3NpdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN3aXBlTW91c2VNb3ZlT2ZmKGV2ZW50KSB7XG4gICAgICAgICAgICBzd2lwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgc3dpcGVNb3VzZU1vdmVPbik7XG5cbiAgICAgICAgICAgIGlzRmFzdFN3aXBlID0gKHN1bW1Td2lwZURpc3RhbmNlID49IDEwMCkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBpZiAoIWlzRmFzdFN3aXBlKSByZXR1cm47XG5cbiAgICAgICAgICAgIHN1bW1Td2lwZURpc3RhbmNlID0gKHN1bW1Td2lwZURpc3RhbmNlID4gKHN3aXBlckxpc3RXaWR0aCAtIHN3aXBlcldpZHRoKSkgPyAoc3dpcGVyTGlzdFdpZHRoIC0gc3dpcGVyV2lkdGgpIDogc3VtbVN3aXBlRGlzdGFuY2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBhZGRpdGlvbmFsU3dpcGVEaXN0YW5jZSA9IChzdW1tU3dpcGVEaXN0YW5jZSAvIDEuNSk7IC8vIDwtLS0tIGNoYW5nZSBzd2lwZSBzcGVlZCwgZm9yIGV4YW1wbGU6IChzdW1tU3dpcGVEaXN0YW5jZSAvIDIuNSlcblxuXG4gICAgICAgICAgICBsZXQgbGFzdEN1cnNvclBvc2l0aW9uID0gZXZlbnQucGFnZVg7XG4gICAgICAgICAgICB3YXlUb1doaWNoU3dpcGVJc01hZGUgPSAobGFzdEN1cnNvclBvc2l0aW9uIDwgZmlyc3RDdXJzb3JQb3NpdGlvbikgPyAnbGVmdCcgOiAncmlnaHQnO1xuXG4gICAgICAgICAgICBzd2lwZUxpc3RNYXJnaW5MZWZ0ID0gcGFyc2VJbnQoc3dpcGVyTGlzdC5zdHlsZS5tYXJnaW5MZWZ0KTtcblxuICAgICAgICAgICAgc3dpdGNoKHdheVRvV2hpY2hTd2lwZUlzTWFkZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOlxuXG4gICAgICAgICAgICAgICAgICAgIGlmICgtc3dpcGVMaXN0TWFyZ2luTGVmdCA+PSAoc3dpcGVyTGlzdFdpZHRoIC0gc3dpcGVyV2lkdGgpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsU3dpcGVEaXN0YW5jZSA9IChhZGRpdGlvbmFsU3dpcGVEaXN0YW5jZSA+ICgoc3dpcGVyTGlzdFdpZHRoIC0gc3dpcGVyV2lkdGgpICsgc3dpcGVMaXN0TWFyZ2luTGVmdCkpID8gKChzd2lwZXJMaXN0V2lkdGggLSBzd2lwZXJXaWR0aCkgKyBzd2lwZUxpc3RNYXJnaW5MZWZ0KSA6IGFkZGl0aW9uYWxTd2lwZURpc3RhbmNlO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXBlckxpc3Quc3R5bGUudHJhbnNpdGlvbiA9ICdhbGwgMC4zNXMnO1xuICAgICAgICAgICAgICAgICAgICBzd2lwZXJMaXN0LnN0eWxlLm1hcmdpbkxlZnQgPSBgJHtzd2lwZUxpc3RNYXJnaW5MZWZ0IC0gYWRkaXRpb25hbFN3aXBlRGlzdGFuY2V9cHhgO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChzd2lwZUxpc3RNYXJnaW5MZWZ0ID49IDAgKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbFN3aXBlRGlzdGFuY2UgPSAoYWRkaXRpb25hbFN3aXBlRGlzdGFuY2UgPiAtc3dpcGVMaXN0TWFyZ2luTGVmdCkgPyAtc3dpcGVMaXN0TWFyZ2luTGVmdCA6IGFkZGl0aW9uYWxTd2lwZURpc3RhbmNlO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXBlckxpc3Quc3R5bGUudHJhbnNpdGlvbiA9ICdhbGwgMC4zNXMnO1xuICAgICAgICAgICAgICAgICAgICBzd2lwZXJMaXN0LnN0eWxlLm1hcmdpbkxlZnQgPSBgJHtzd2lwZUxpc3RNYXJnaW5MZWZ0ICsgYWRkaXRpb25hbFN3aXBlRGlzdGFuY2V9cHhgO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBzd2lwZXJMaXN0LnN0eWxlLnRyYW5zaXRpb24gPSAnYWxsIDBzJztcbiAgICAgICAgICAgIH0sIDI1MCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHN3aXBlci5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgc3dpcGVNb3VzZU1vdmVPZmYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3dpcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN3aXBlKTtcbn0pKCk7XG4oKCkgPT4ge1xuICBjb25zdCBtb2RhbFRyaWdnZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnKltkYXRhLW1vZGFsLXRhcmdldF0nKTtcbiAgY29uc3QgY2xvc2VNb2RhbEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcqW2RhdGEtbW9kYWwtY2xvc2VdJyk7XG4gIGxldCBvcGVuZWRNb2RhbElEO1xuXG4gIGNvbnN0IG9wZW5Nb2RhbFdpbmRvdyA9IChldnQpID0+IHtcbiAgICBjb25zdCB0YXJnZXQgPSBldnQuY3VycmVudFRhcmdldDtcbiAgICBjb25zdCBtb2RhbElEID0gdGFyZ2V0LmRhdGFzZXQubW9kYWxUYXJnZXQ7XG4gICAgY29uc3QgdGFyZ2V0TW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtb2RhbElEKTtcblxuICAgIChvcGVuZWRNb2RhbElEICE9PSB1bmRlZmluZWQpID8gY2xvc2VNb2RhbFdpbmRvdyhvcGVuZWRNb2RhbElEKSA6IG51bGw7XG5cbiAgICAobW9kYWxJRCA9PT0gJ3NlcnZpY2UtZXhhbXBsZScpID8gY3JlYXRlU2VydmljZUV4YW1wbGVNb2RhbCh0YXJnZXQsIHRhcmdldE1vZGFsKSA6IG51bGw7XG5cbiAgICBvcGVuZWRNb2RhbElEID0gbW9kYWxJRDtcblxuICAgIHRhcmdldE1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Zpc2libGUnKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JykuY2xhc3NMaXN0LmFkZCgnZml4ZWQnKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWxCeUJhY2tncm91bmQpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VNb2RhbEJ5RXNjKTtcblxuICAgIGNvbnN0XG4gICAgICBmb2N1c2FibGVFbGVtZW50cyA9IHRhcmdldE1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZl06bm90KFtkaXNhYmxlZF0pLCBidXR0b246bm90KFtkaXNhYmxlZF0pLCB0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSksIGlucHV0W3R5cGU9XCJ0ZXh0XCJdOm5vdChbZGlzYWJsZWRdKSwgaW5wdXRbdHlwZT1cInJhZGlvXCJdOm5vdChbZGlzYWJsZWRdKSwgaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdOm5vdChbZGlzYWJsZWRdKSwgc2VsZWN0Om5vdChbZGlzYWJsZWRdKScpLFxuICAgICAgZmlyc3RGb2N1c2FibGVFbGVtZW50ID0gZm9jdXNhYmxlRWxlbWVudHNbMF0sXG4gICAgICBsYXN0Rm9jdXNhYmxlRWxlbWVudCA9IGZvY3VzYWJsZUVsZW1lbnRzW2ZvY3VzYWJsZUVsZW1lbnRzLmxlbmd0aCAtIDFdO1xuXG4gICAgZnVuY3Rpb24gbG9ja0ZvY3VzSW5Nb2RhbChldmVudCkge1xuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ1RhYicgfHwgZXZlbnQua2V5Q29kZSA9PT0gOSkge1xuICAgICAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gZmlyc3RGb2N1c2FibGVFbGVtZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGFzdEZvY3VzYWJsZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGxhc3RGb2N1c2FibGVFbGVtZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAgXG4gICAgICAgICAgICBmaXJzdEZvY3VzYWJsZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0YXJnZXRNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgbG9ja0ZvY3VzSW5Nb2RhbCk7XG5cbiAgfTtcblxuICBjb25zdCBjbG9zZU1vZGFsQnlFc2MgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICBjbG9zZU1vZGFsV2luZG93KG9wZW5lZE1vZGFsSUQpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjbG9zZU1vZGFsQnlCYWNrZ3JvdW5kID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX2JnJykpIHtcbiAgICAgIGNsb3NlTW9kYWxXaW5kb3cob3BlbmVkTW9kYWxJRCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNsb3NlTW9kYWxCeUJ1dHRvbiA9IChldnQpID0+IGNsb3NlTW9kYWxXaW5kb3coZXZ0LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5tb2RhbENsb3NlKTtcblxuICBjb25zdCBjbG9zZU1vZGFsV2luZG93ID0gKG1vZGFsSUQpID0+IHtcbiAgICBjb25zdCB0YXJnZXRNb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1vZGFsSUQpO1xuXG4gICAgdGFyZ2V0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgndmlzaWJsZScpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5jbGFzc0xpc3QucmVtb3ZlKCdmaXhlZCcpO1xuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbEJ5QmFja2dyb3VuZCk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZU1vZGFsQnlFc2MpO1xuICAgIC8vIHRhcmdldE1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBsb2NrRm9jdXNJbk1vZGFsKTtcbiAgfTtcblxuICBjb25zdCBpbml0aWFsaXplTW9kYWxUcmlnZ2VycyA9ICgpID0+IHtcbiAgICBmb3IgKGNvbnN0IGJ1dHRvbiBvZiBtb2RhbFRyaWdnZXJzKSB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuTW9kYWxXaW5kb3cpO1xuICAgIH1cbiAgfTtcblxuICBjbG9zZU1vZGFsQnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vZGFsQnlCdXR0b24pKTtcblxuICB3aW5kb3cubW9kYWxzID0ge1xuICAgIG9wZW5Nb2RhbFdpbmRvdzogb3Blbk1vZGFsV2luZG93LFxuICAgIGNsb3NlTW9kYWxXaW5kb3c6IGNsb3NlTW9kYWxXaW5kb3csXG4gIH07XG5cbiAgZnVuY3Rpb24gY3JlYXRlU2VydmljZUV4YW1wbGVNb2RhbCh0YXJnZXQsIHRhcmdldE1vZGFsKSB7XG4gICAgY29uc3RcbiAgICAgIHNlcnZpY2VUaXRsZSA9IHRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy53aGF0LXlvdS1nZXRfX2l0ZW0tdGl0bGUnKS50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHMrL2csJyAnKS50cmltKCksXG4gICAgICBtb2RhbFRpdGxlID0gdGFyZ2V0TW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX190aXRsZScpLFxuICAgICAgcGF0aFRvSW1hZ2UgPSB0YXJnZXQuZGF0YXNldC5tb2RhbFNlcnZpY2VFeGFtcGxlSW1hZ2UsXG4gICAgICBtb2RhbEltYWdlID0gdGFyZ2V0TW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpO1xuICAgIFxuICAgIG1vZGFsVGl0bGUudGV4dENvbnRlbnQgPSBzZXJ2aWNlVGl0bGU7XG4gICAgbW9kYWxJbWFnZS5zcmMgPSBwYXRoVG9JbWFnZTtcbiAgfVxuXG4gIGluaXRpYWxpemVNb2RhbFRyaWdnZXJzKCk7XG5cbn0pKCk7XG4oKCkgPT4ge1xuICBjb25zdCBzY3JvbGxpbmdMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJypbZGF0YS1zY3JvbGwtbGlua10nKTtcblxuICBjb25zdCBzY3JvbGxUb0VsZW1lbnQgPSAoZXZ0KSA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcbiAgICBjb25zdCBzY3JvbGxUbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldC5kYXRhc2V0LnNjcm9sbExpbmspO1xuXG4gICAgaWYgKHNjcm9sbFRvKSB7XG4gICAgICBzY3JvbGxUby5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJ1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGlmKEJvb2xlYW4oc2Nyb2xsaW5nTGlua3MpKSB7XG4gICAgc2Nyb2xsaW5nTGlua3MuZm9yRWFjaChsaW5rID0+IGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzY3JvbGxUb0VsZW1lbnQpKTtcbiAgfVxufSkoKTtcbigoKSA9PiB7XG5cbiAgLy8gY29uc3QgbGF6eVBpY3R1cmVzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwicGljdHVyZS5sYXp5XCIpKTtcblxuICAvLyBmdW5jdGlvbiBsYXp5bG9hZE9uSW50ZXJzZWN0aW9uKCkge1xuICAvLyAgIGlmIChcIkludGVyc2VjdGlvbk9ic2VydmVyXCIgaW4gd2luZG93KSB7XG4gIC8vICAgICBsZXQgbGF6eVBpY3R1cmVPYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihmdW5jdGlvbihlbnRyaWVzLCBvYnNlcnZlcikge1xuICAvLyAgICAgICBlbnRyaWVzLmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcbiAgLy8gICAgICAgICBpZiAoZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgLy8gICAgICAgICAgIGxldCBsYXp5UGljdHVyZSA9IGVudHJ5LnRhcmdldDtcbiAgLy8gICAgICAgICAgIGxldCBsYXp5V2VicEltYWdlID0gbGF6eVBpY3R1cmUucXVlcnlTZWxlY3RvcignW3R5cGU9XCJpbWFnZS93ZWJwXCJdJyk7XG4gIC8vICAgICAgICAgICBsZXQgbGF6eUltYWdlID0gbGF6eVBpY3R1cmUucXVlcnlTZWxlY3RvcignaW1nJyk7XG4gIC8vXG4gIC8vICAgICAgICAgICBsYXp5V2VicEltYWdlLnNyY3NldCA9IGxhenlXZWJwSW1hZ2UuZGF0YXNldC5zcmM7XG4gIC8vICAgICAgICAgICBsYXp5SW1hZ2Uuc3JjID0gbGF6eUltYWdlLmRhdGFzZXQuc3JjO1xuICAvL1xuICAvLyAgICAgICAgICAgbGF6eVBpY3R1cmUuc2V0QXR0cmlidXRlKCdkYXRhLXBpY3R1cmUnLCAnb3BhY2l0eS0xJyk7XG4gIC8vICAgICAgICAgICBsYXp5UGljdHVyZS5jbGFzc0xpc3QucmVtb3ZlKFwibGF6eVwiKTtcbiAgLy8gICAgICAgICAgIGxhenlQaWN0dXJlT2JzZXJ2ZXIudW5vYnNlcnZlKGxhenlQaWN0dXJlKTtcbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgfSk7XG4gIC8vXG4gIC8vICAgICBsYXp5UGljdHVyZXMuZm9yRWFjaChmdW5jdGlvbihsYXp5UGljdHVyZSkge1xuICAvLyAgICAgICBsYXp5UGljdHVyZU9ic2VydmVyLm9ic2VydmUobGF6eVBpY3R1cmUpO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vXG4gIC8vIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGxhenlsb2FkT25JbnRlcnNlY3Rpb24pO1xuXG5cbiAgLy8gZnVuY3Rpb24gbGF6eWxvYWRPbkxvYWRQYWdlKCkge1xuICAvLyAgIGxldCBsYXp5UGljdHVyZU9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnNlcnZlcikgPT4ge1xuICAvLyAgICAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKGVudHJ5KSB7XG4gIC8vICAgICAgIGxldCBsYXp5UGljdHVyZSA9IGVudHJ5LnRhcmdldDtcbiAgLy8gICAgICAgbGV0IGxhenlXZWJwSW1hZ2UgPSBsYXp5UGljdHVyZS5xdWVyeVNlbGVjdG9yKCdbdHlwZT1cImltYWdlL3dlYnBcIl0nKTtcbiAgLy8gICAgICAgbGV0IGxhenlJbWFnZSA9IGxhenlQaWN0dXJlLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuICAvL1xuICAvLyAgICAgICBsYXp5V2VicEltYWdlLnNyY3NldCA9IGxhenlXZWJwSW1hZ2UuZGF0YXNldC5zcmM7XG4gIC8vICAgICAgIGxhenlJbWFnZS5zcmMgPSBsYXp5SW1hZ2UuZGF0YXNldC5zcmM7XG4gIC8vXG4gIC8vICAgICAgIGxhenlQaWN0dXJlLnNldEF0dHJpYnV0ZSgnZGF0YS1waWN0dXJlJywgJ29wYWNpdHktMScpO1xuICAvLyAgICAgICBsYXp5UGljdHVyZS5jbGFzc0xpc3QucmVtb3ZlKFwibGF6eVwiKTtcbiAgLy8gICAgICAgbGF6eVBpY3R1cmVPYnNlcnZlci51bm9ic2VydmUobGF6eVBpY3R1cmUpO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfSk7XG4gIC8vXG4gIC8vICAgbGF6eVBpY3R1cmVzLmZvckVhY2goZnVuY3Rpb24obGF6eVBpY3R1cmUpIHtcbiAgLy8gICAgIGxhenlQaWN0dXJlT2JzZXJ2ZXIub2JzZXJ2ZShsYXp5UGljdHVyZSk7XG4gIC8vICAgfSk7XG4gIC8vIH1cblxuICBmdW5jdGlvbiBsYXp5bG9hZE9uTG9hZFBhZ2UoKSB7XG4gICAgY29uc3QgbGF6eVBpY3R1cmVzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwicGljdHVyZS5sYXp5XCIpKTtcblxuICAgIGxhenlQaWN0dXJlcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgbGV0IGxhenlQaWN0dXJlID0gZW50cnk7XG4gICAgICBsZXQgbGF6eVdlYnBJbWFnZSA9IGxhenlQaWN0dXJlLnF1ZXJ5U2VsZWN0b3IoJ1t0eXBlPVwiaW1hZ2Uvd2VicFwiXScpO1xuICAgICAgbGV0IGxhenlJbWFnZSA9IGxhenlQaWN0dXJlLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuXG4gICAgICBsYXp5V2VicEltYWdlLnNyY3NldCA9IGxhenlXZWJwSW1hZ2UuZGF0YXNldC5zcmM7XG4gICAgICBsYXp5SW1hZ2Uuc3JjID0gbGF6eUltYWdlLmRhdGFzZXQuc3JjO1xuXG4gICAgICBsYXp5UGljdHVyZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGljdHVyZScsICdvcGFjaXR5LTEnKTtcbiAgICAgIGxhenlQaWN0dXJlLmNsYXNzTGlzdC5yZW1vdmUoXCJsYXp5XCIpO1xuICAgIH0pO1xuICB9XG5cblxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgbGF6eWxvYWRPbkxvYWRQYWdlKTtcblxufSkoKTtcbigoKSA9PiB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1haW5CbG9ja3MgPSBbXS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc21vb3RoLWRpc3BsYXktYmxvY2tcIikpO1xuICBcbiAgICBpZiAoXCJJbnRlcnNlY3Rpb25PYnNlcnZlclwiIGluIHdpbmRvdykge1xuICAgICAgbGV0IG1haW5CbG9ja09ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGZ1bmN0aW9uKGVudHJpZXMsIG9ic2VydmVyKSB7XG4gICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbihlbnRyeSkge1xuICAgICAgICAgIGlmIChlbnRyeS5pc0ludGVyc2VjdGluZykge1xuICAgICAgICAgICAgbGV0IG1haW5CbG9jayA9IGVudHJ5LnRhcmdldDtcblxuICAgICAgICAgICAgbWFpbkJsb2NrLnNldEF0dHJpYnV0ZShcImRhdGEtc21vb3RoLWRpc3BsYXktYmxvY2tcIiwgXCJhY3RpdmVcIik7XG4gICAgICAgICAgICBtYWluQmxvY2tPYnNlcnZlci51bm9ic2VydmUobWFpbkJsb2NrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gIFxuICAgICAgbWFpbkJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uKG1haW5CbG9jaykge1xuICAgICAgICBtYWluQmxvY2tPYnNlcnZlci5vYnNlcnZlKG1haW5CbG9jayk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuICB9KSgpO1xuXG5tZWRpdW1ab29tKCdbZGF0YS16b29tYWJsZV0nKTsiXX0=
